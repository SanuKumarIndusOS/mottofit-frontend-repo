{"version":3,"sources":["component/TrainerDashBoard/DashboardCompontents/TrainerMessages/index.js","action/messagingAct.js","component/common/Message/ChatItem.js","helpers/Messaging.js","component/common/Message/ChatBox.js","assets/files/TrainerDashboard/Message/Jenny.png","assets/files/TrainerDashboard/Message/Availability Icon.svg","assets/files/TrainerDashboard/Message/Location Icon.svg","assets/files/TrainerDashboard/Message/Image 1.png","assets/files/TrainerDashboard/Message/Shedule Icon.svg"],"names":["TrainerMessage","require","connect","state","clientData","messagingReducer","activeChannel","activeChannelMessages","typingMembers","chatClientInstance","dispatch","bindActionCreators","trainerChannel","initClientDispatch","updateMessagingDetails","useState","individual_list","setIndividual","socialGroup_list","setSocialGroup_list","admin_list","setAdmin_list","PopulateContacts","channelID","members","channelData","console","log","joinChannelByID","then","currentChannelMembers","handleTabChange","unSubscribeChannel","useEffect","data","individualClient","socialGroups","admins","removeChatClient","className","defaultTab","tabFor","onClick","tabId","map","item","index","message","from","body","date_updated","lastUserProfilePic","filter","userId","src","profilePicture","Jenny","alt","userName","onError","e","target","onerror","getFormatDate","Date","now","isDataPresent","length","updatePersonTyping","payload","getState","type","identity","participant","tempMembers","currentChatItemOwner","userIdenity","currentPerson","includes","MessagingActionType","UPDATE_MESSAGING_DETAILS","person","resetChannelDetails","RESET_CHANNEL_DETAILS","UPDATE_CLIENT_INSTANCE","ChatClientInstance","ChatItem","CurrentMessageComponent","currMsg","date","msgTime","moment","timestamp","format","isMyMsg","author","localStorage","getItem","Jonn","Chat","TwilioMessaging","handler","initClient","a","getToken","token","Client","create","client","INITIALIZE_CLIENT","initClientListeners","removeAllListeners","on","onParticipantStartTyping","onParticipantEndedTyping","updateToken","uniqueChannelId","Promise","resolve","reject","alert","isLoading","getChannelByUniqueName","channel","joinChannel","onChanelJoined","onMessagedAdded","member","onMemberJoined","onMemberLeft","UPDATE_CHANNEL_DETAILS","channelState","status","join","getMessages","messages","tempMessage","items","sid","UPDATE_MESSAGE_DETAILS","getIdentityToken","twilioApi","id","api","chatToken","catch","err","Toast","this","ChatBoxClass","props","scrollToMessageListBottom","messagesEndRef","current","scrollTo","scrollHeight","handleChange","value","setState","typing","handleSendMessage","preventDefault","sendMessage","String","formatMessage","lastMsgDate","formattedMessage","reduce","prevMsgArray","tempPrevMsgArray","currYear","msgYear","tempMsgDate","msgDate","React","createRef","prevProps","setTimeout","tempMsg","chatTitle","SheduleIcon","startTime","toDateString","AvailabilityIcon","toLocaleTimeString","LocationIcon","venue","toString","ref","onSubmit","placeholder","onChange","Component","ChatBox"],"mappings":"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","file":"static/js/21.47415ad9.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport { Tabs, Tab, TabPanel, TabList } from \"react-web-tabs\";\r\nimport \"react-web-tabs/dist/react-web-tabs.css\";\r\nimport \"./style.scss\";\r\nimport Jenny from \"../../../../assets/files/TrainerDashboard/Message/Jenny.png\";\r\nimport Jonn from \"../../../../assets/files/TrainerDashboard/Message/Image 1.png\";\r\nimport SheduleIcon from \"../../../../assets/files/TrainerDashboard/Message/Shedule Icon.svg\";\r\nimport AvailabilityIcon from \"../../../../assets/files/TrainerDashboard/Message/Availability Icon.svg\";\r\nimport LocationIcon from \"../../../../assets/files/TrainerDashboard/Message/Location Icon.svg\";\r\nimport BlueHoverButton from \"../../../common/BlueArrowButton/index\";\r\nimport { trainerChannel } from \"action/trainerAct\";\r\nimport { connect } from \"react-redux\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { twilioApi } from \"../../../../service/apiVariables\";\r\nimport { api } from \"../../../../service/api\";\r\nimport { Toast } from \"../../../../service/toast\";\r\nimport ChatBox from \"component/common/Message/ChatBox\";\r\nimport {\r\n  initClientDispatch,\r\n  updateMessagingDetails,\r\n} from \"action/messagingAct\";\r\nimport { getFormatDate } from \"service/helperFunctions\";\r\nconst Chatt = require(\"twilio-chat\");\r\n\r\nconst TrainerMessageClass = ({\r\n  trainerChannel,\r\n  initClientDispatch,\r\n  clientData,\r\n  activeChannel,\r\n  activeChannelMessages,\r\n  typingMembers,\r\n  chatClientInstance,\r\n  updateMessagingDetails,\r\n}) => {\r\n  const [individual_list, setIndividual] = useState([]);\r\n  const [socialGroup_list, setSocialGroup_list] = useState([]);\r\n  const [admin_list, setAdmin_list] = useState([]);\r\n  const [Channel, setChannel] = useState([]);\r\n  const [Client, setClient] = useState();\r\n  const [messages, setMessages] = useState([]);\r\n  const [text_thread, setText_thread] = useState([]);\r\n  const [chattoken, setToken] = useState(\"\");\r\n  const [channel_id, setChannel_id] = useState(\"\");\r\n\r\n  // Make Id dynamic\r\n  useEffect(() => {\r\n    // Get Contact_list\r\n\r\n    initClientDispatch();\r\n\r\n    trainerChannel().then((data) => {\r\n      setIndividual(data.individualClient);\r\n      setSocialGroup_list(data.socialGroups);\r\n      setAdmin_list(data.admins);\r\n    });\r\n\r\n    return () => {\r\n      chatClientInstance && chatClientInstance.removeChatClient();\r\n    };\r\n  }, []);\r\n\r\n  function PopulateContacts(channelID, members, channelData) {\r\n    console.log(channelID, chatClientInstance);\r\n\r\n    // \"CH15f50302975a435799691ca5f8d71092\";\r\n    chatClientInstance.joinChannelByID(channelID).then(() => {\r\n      console.log(\"Channel Loaded\");\r\n\r\n      let reduxData = {\r\n        currentChannelMembers: members,\r\n        channelData,\r\n      };\r\n\r\n      updateMessagingDetails(reduxData);\r\n    });\r\n  }\r\n\r\n  function handleTabChange() {\r\n    chatClientInstance && chatClientInstance.unSubscribeChannel();\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"main_message_container\">\r\n        <div className=\"message_outter_container\">\r\n          <h2>Messages</h2>\r\n          <div className=\"message_inner\">\r\n            <div className=\"message_wrapper\">\r\n              <Tabs defaultTab=\"one\">\r\n                <TabList>\r\n                  <Tab tabFor=\"one\" onClick={handleTabChange}>\r\n                    All\r\n                  </Tab>\r\n                  <Tab tabFor=\"two\" onClick={handleTabChange}>\r\n                    INDIVIDUAL CLIENTS\r\n                  </Tab>\r\n                  <Tab tabFor=\"three\" onClick={handleTabChange}>\r\n                    SOCIAL GROUPS\r\n                  </Tab>\r\n                  <Tab tabFor=\"four\" onClick={handleTabChange}>\r\n                    ADMIN\r\n                  </Tab>\r\n                </TabList>\r\n                <div className=\"message_inner\">\r\n                  <TabPanel tabId=\"one\">\r\n                    <div className=\"message_inner_one\">\r\n                      <div className=\"message_left\">\r\n                        {/* Todo Change to ALL */}\r\n                        {[\r\n                          ...individual_list,\r\n                          ...socialGroup_list,\r\n                          ...admin_list,\r\n                        ].map((item, index) => {\r\n                          const { from, body, date_updated } = item.message;\r\n\r\n                          let lastUserProfilePic =\r\n                            item[\"members\"]?.filter(\r\n                              ({ userId }) => userId === from\r\n                            )[0] || {};\r\n\r\n                          return (\r\n                            <div\r\n                              className=\"contact_item\"\r\n                              key={`${Date.now()}_all_${index}`}\r\n                            >\r\n                              <div className=\"inner_link\">\r\n                                <img\r\n                                  src={\r\n                                    lastUserProfilePic?.profilePicture || Jenny\r\n                                  }\r\n                                  alt={`${lastUserProfilePic?.userName} profile`}\r\n                                  onError={(e) => {\r\n                                    e.target.onerror = null;\r\n                                    e.target.src = Jenny;\r\n                                  }}\r\n                                />\r\n\r\n                                <div\r\n                                  className=\"message_link_notify\"\r\n                                  onClick={() =>\r\n                                    PopulateContacts(\r\n                                      item[\"channelUniqueName\"],\r\n                                      item[\"members\"],\r\n                                      item\r\n                                    )\r\n                                  }\r\n                                >\r\n                                  <h3>{item[\"chatTitle\"] || \"\"}</h3>\r\n                                  <div>\r\n                                    {body && <p>{body}</p>}\r\n                                    {date_updated && (\r\n                                      <span className=\"msg-timestamp-left\">\r\n                                        {getFormatDate(date_updated, \"LT\")}\r\n                                      </span>\r\n                                    )}\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                      <div className=\"message_right\">\r\n                        <ChatBox\r\n                          isDataPresent={\r\n                            [\r\n                              ...individual_list,\r\n                              ...socialGroup_list,\r\n                              ...admin_list,\r\n                            ].length > 0\r\n                          }\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </TabPanel>\r\n                  <TabPanel tabId=\"two\">\r\n                    <div className=\"message_inner_one\">\r\n                      <div className=\"message_left\">\r\n                        {/* Todo Change to ALL */}\r\n                        {individual_list.map((item, index) => {\r\n                          const { from, body, date_updated } = item.message;\r\n\r\n                          let lastUserProfilePic =\r\n                            item[\"members\"]?.filter(\r\n                              ({ userId }) => userId === from\r\n                            )[0] || {};\r\n                          return (\r\n                            <div\r\n                              className=\"contact_item\"\r\n                              key={`${Date.now()}_${index}`}\r\n                            >\r\n                              <div className=\"inner_link\">\r\n                                <img\r\n                                  src={\r\n                                    lastUserProfilePic?.profilePicture || Jenny\r\n                                  }\r\n                                  alt={`${lastUserProfilePic?.userName} profile`}\r\n                                  onError={(e) => {\r\n                                    e.target.onerror = null;\r\n                                    e.target.src = Jenny;\r\n                                  }}\r\n                                />\r\n                                <div\r\n                                  className=\"message_link_notify\"\r\n                                  onClick={() =>\r\n                                    PopulateContacts(\r\n                                      item[\"channelUniqueName\"],\r\n                                      item[\"members\"],\r\n                                      item\r\n                                    )\r\n                                  }\r\n                                >\r\n                                  <h3>{item[\"chatTitle\"] || \"\"}</h3>\r\n                                  <div>\r\n                                    {body && <p>{body}</p>}\r\n                                    {date_updated && (\r\n                                      <span className=\"msg-timestamp-left\">\r\n                                        {getFormatDate(date_updated, \"LT\")}\r\n                                      </span>\r\n                                    )}\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                      <div className=\"message_right\">\r\n                        <ChatBox isDataPresent={individual_list.length > 0} />\r\n                      </div>\r\n                    </div>\r\n                  </TabPanel>\r\n                  <TabPanel tabId=\"three\">\r\n                    <div className=\"message_inner_one\">\r\n                      <div className=\"message_left\">\r\n                        {/* Todo Change to ALL */}\r\n                        {socialGroup_list.map((item, index) => {\r\n                          const { from, body, date_updated } = item.message;\r\n\r\n                          let lastUserProfilePic =\r\n                            item[\"members\"]?.filter(\r\n                              ({ userId }) => userId === from\r\n                            )[0] || {};\r\n                          return (\r\n                            <div\r\n                              className=\"contact_item\"\r\n                              key={`${index}_${Date.now()}`}\r\n                            >\r\n                              <div className=\"inner_link\">\r\n                                <img\r\n                                  src={\r\n                                    lastUserProfilePic?.profilePicture || Jenny\r\n                                  }\r\n                                  alt={`${lastUserProfilePic?.userName} profile`}\r\n                                  onError={(e) => {\r\n                                    e.target.onerror = null;\r\n                                    e.target.src = Jenny;\r\n                                  }}\r\n                                />\r\n                                <div\r\n                                  className=\"message_link_notify\"\r\n                                  onClick={() =>\r\n                                    PopulateContacts(\r\n                                      item[\"channelUniqueName\"],\r\n                                      item[\"members\"],\r\n                                      item\r\n                                    )\r\n                                  }\r\n                                >\r\n                                  <h3>{item[\"chatTitle\"] || \"\"}</h3>\r\n                                  <div>\r\n                                    {body && <p>{body}</p>}\r\n                                    {date_updated && (\r\n                                      <span className=\"msg-timestamp-left\">\r\n                                        {getFormatDate(date_updated, \"LT\")}\r\n                                      </span>\r\n                                    )}\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                      <div className=\"message_right\">\r\n                        <ChatBox isDataPresent={socialGroup_list.length > 0} />\r\n                      </div>\r\n                    </div>\r\n                  </TabPanel>\r\n                  <TabPanel tabId=\"four\">\r\n                    <div className=\"message_inner_one\">\r\n                      <div className=\"message_left\">\r\n                        {/* Todo Change to ALL */}\r\n                        {admin_list.map((item) => {\r\n                          const { from, body, date_updated } = item.message;\r\n\r\n                          let lastUserProfilePic =\r\n                            item[\"members\"]?.filter(\r\n                              ({ userId }) => userId === from\r\n                            )[0] || {};\r\n                          return (\r\n                            <div className=\"contact_item\">\r\n                              <div className=\"inner_link\">\r\n                                <img\r\n                                  src={\r\n                                    lastUserProfilePic?.profilePicture || Jenny\r\n                                  }\r\n                                  alt={`${lastUserProfilePic?.userName} profile`}\r\n                                  onError={(e) => {\r\n                                    e.target.onerror = null;\r\n                                    e.target.src = Jenny;\r\n                                  }}\r\n                                />\r\n                                <div\r\n                                  className=\"message_link_notify\"\r\n                                  onClick={() =>\r\n                                    PopulateContacts(\r\n                                      item[\"channelUniqueName\"],\r\n                                      item[\"members\"],\r\n                                      item\r\n                                    )\r\n                                  }\r\n                                >\r\n                                  <h3>{item[\"chatTitle\"] || \"\"}</h3>\r\n                                  <div>\r\n                                    {body && <p>{body}</p>}\r\n                                    {date_updated && (\r\n                                      <span className=\"msg-timestamp-left\">\r\n                                        {getFormatDate(date_updated, \"LT\")}\r\n                                      </span>\r\n                                    )}\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                      <div className=\"message_right\">\r\n                        <ChatBox isDataPresent={admin_list.length > 0} />\r\n                      </div>\r\n                    </div>\r\n                  </TabPanel>\r\n                </div>\r\n              </Tabs>\r\n              <div className=\"\"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\nconst RightChat = (props) => {\r\n  return (\r\n    <>\r\n      <div className=\"message_chat_right\">\r\n        <div className=\"message_text\">\r\n          <h5>{props.data}</h5>\r\n        </div>\r\n\r\n        <img src={Jonn} alt=\"icon\" />\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n// const LeftChat = (props) => {\r\n//     return (\r\n//         <>\r\n//             <div className=\"message_chat_right\">\r\n//                 <div className=\"message_text\">\r\n//                     <h5>{props.data}</h5>\r\n//                 </div>\r\n\r\n//                 <img src={Jonn} alt=\"icon\" />\r\n//             </div>\r\n//         </>\r\n//     );\r\n// };\r\n\r\nconst mapStateToProps = (state) => ({\r\n  clientData: state.messagingReducer.clientData,\r\n  activeChannel: state.messagingReducer.activeChannel,\r\n  activeChannelMessages: state.messagingReducer.activeChannelMessages,\r\n  typingMembers: state.messagingReducer.typingMembers,\r\n  chatClientInstance: state.messagingReducer.chatClientInstance,\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return bindActionCreators(\r\n    {\r\n      trainerChannel,\r\n      initClientDispatch,\r\n      updateMessagingDetails,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nconst TrainerMessage = connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(TrainerMessageClass);\r\n\r\nexport default TrainerMessage;\r\n","import { MessagingActionType } from \"../service/actionType\";\r\nimport ChatClientInstance from \"../helpers/Messaging\";\r\n\r\nexport const updatePersonTyping = (payload) => (dispatch, getState) => {\r\n  const { typingMembers, currentChannelMembers } = getState().messagingReducer;\r\n  const { type, participant } = payload;\r\n  let { identity } = participant.state;\r\n  let tempMembers = typingMembers;\r\n\r\n  const currentChatItemOwner =\r\n    currentChannelMembers.filter(\r\n      ({ userIdenity }) => userIdenity === identity\r\n    )[0] || {};\r\n\r\n  let currentPerson = currentChatItemOwner?.userName || identity;\r\n\r\n  if (type === \"typingStarted\") {\r\n    // console.log(typingMembers, identity);\r\n\r\n    if (!typingMembers.includes(currentPerson)) {\r\n      tempMembers = [...typingMembers, currentPerson];\r\n\r\n      dispatch({\r\n        type: MessagingActionType.UPDATE_MESSAGING_DETAILS,\r\n        payload: { typingMembers: [...tempMembers] },\r\n      });\r\n    }\r\n  } else if (type === \"typingEnded\") {\r\n    // console.log(typingMembers, currentPerson);\r\n    if (typingMembers.includes(currentPerson)) {\r\n      tempMembers = [...typingMembers].filter(\r\n        (person) => person !== currentPerson\r\n      );\r\n      dispatch({\r\n        type: MessagingActionType.UPDATE_MESSAGING_DETAILS,\r\n        payload: { typingMembers: [...tempMembers] },\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nexport const resetChannelDetails = () => (dispatch) => {\r\n  dispatch({\r\n    type: MessagingActionType.RESET_CHANNEL_DETAILS,\r\n  });\r\n};\r\n\r\nexport const updateMessagingDetails = (payload) => (dispatch) => {\r\n  dispatch({\r\n    type: MessagingActionType.UPDATE_MESSAGING_DETAILS,\r\n    payload,\r\n  });\r\n};\r\n\r\nexport const initClientDispatch = () => (dispatch, getState) => {\r\n  dispatch({\r\n    type: MessagingActionType.UPDATE_CLIENT_INSTANCE,\r\n    payload: new ChatClientInstance(dispatch, getState),\r\n  });\r\n};\r\n","import React from \"react\";\r\nimport moment from \"moment\";\r\n\r\nimport Jonn from \"../../../assets/files/TrainerDashboard/Message/Image 1.png\";\r\n\r\nexport const ChatItem = ({\r\n  currentChannelMembers = [],\r\n  currMsg: { type, state, date },\r\n}) => {\r\n  let CurrentMessageComponent;\r\n\r\n  if (type === \"message\") {\r\n    let msgCreatedDate = moment(state.timestamp);\r\n\r\n    let msgTime = msgCreatedDate.format(\"LT\");\r\n\r\n    const isMyMsg = state?.author === localStorage.getItem(\"user-id\");\r\n\r\n    const currentChatItemOwner =\r\n      currentChannelMembers.filter(\r\n        ({ userIdenity }) => userIdenity === state.author\r\n      )[0] || {};\r\n\r\n    CurrentMessageComponent = (\r\n      <div className={`message_chat_${isMyMsg ? \"right\" : \"left\"}`}>\r\n        <div className=\"message_text\">\r\n          <h5>{state?.body || \"\"}</h5>\r\n          <span className=\"msg-time\">{msgTime}</span>\r\n        </div>\r\n\r\n        <img\r\n          src={currentChatItemOwner?.profilePicture || Jonn}\r\n          alt=\"icon\"\r\n          onError={(e) => {\r\n            e.target.onerror = null;\r\n            e.target.src = Jonn;\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  } else {\r\n    CurrentMessageComponent = (\r\n      <div className=\"w-100 d-flex align-items-center justify-content-center my-3\">\r\n        <span className=\"info-badge\">{date}</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return <div>{CurrentMessageComponent}</div>;\r\n};\r\n","// import config from \"../../config\";\r\n\r\nimport { MessagingActionType } from \"../service/actionType\";\r\nimport { twilioApi } from \"../service/apiVariables\";\r\nimport { api } from \"../service/api\";\r\nimport { Toast } from \"../service/toast\";\r\nimport {\r\n  updatePersonTyping,\r\n  resetChannelDetails,\r\n} from \"../action/messagingAct\";\r\n\r\nconst Chat = require(\"twilio-chat\");\r\n\r\nexport default class TwilioMessaging {\r\n  constructor(handler, getState) {\r\n    this.getState = getState;\r\n\r\n    this.handler = handler;\r\n\r\n    this.activeChannel = null;\r\n\r\n    this.client = null;\r\n\r\n    this.initClient();\r\n  }\r\n\r\n  initClient = async () => {\r\n    const token = await this.getToken();\r\n\r\n    const client = await Chat.Client.create(token);\r\n\r\n    this.client = client;\r\n\r\n    this.handler({\r\n      type: MessagingActionType.INITIALIZE_CLIENT,\r\n      payload: client,\r\n    });\r\n\r\n    this.initClientListeners(client);\r\n  };\r\n\r\n  initClientListeners = (client) => {\r\n    // REMOVE ALL THE EXISTING LISTENERS\r\n    client.removeAllListeners();\r\n\r\n    // client.on(\"channelJoined\", async (channel) => {\r\n    //   // getting list of all messages since this is an existing channel\r\n    //   console.log(channel);\r\n\r\n    //   await this.onChanelJoined(channel);\r\n    // });\r\n\r\n    // LISTEN FOR GLOBAL MESSAGES\r\n\r\n    // client.on(\"messageAdded\", async (message) => {\r\n    //   await this.handler(this.onMessagedAdded(message));\r\n    // });\r\n\r\n    // LISTEN FOR PERSON WHOSE ARE TYPING\r\n    client.on(\"typingStarted\", (participant) => {\r\n      this.onParticipantStartTyping(participant);\r\n    });\r\n\r\n    // LISTEN FOR PERSON WHOM HAVE STOP TYPING\r\n    client.on(\"typingEnded\", (participant) => {\r\n      this.onParticipantEndedTyping(participant);\r\n    });\r\n\r\n    //LISTEN AND UPDATE IF TOKEN IS ABOUT TO EXPIRE\r\n\r\n    client.on(\"tokenAboutToExpire\", async () => {\r\n      this.log(\"token is about to expire\");\r\n      const token = await this.getToken();\r\n      client.updateToken(token);\r\n    });\r\n\r\n    // LISTEN IF ALREADY TOKEN HAS EXPIRED\r\n\r\n    client.on(\"tokenExpired\", async () => {\r\n      this.log(\"token is about to expire\");\r\n      const token = await this.getToken();\r\n      client.updateToken(token);\r\n    });\r\n  };\r\n\r\n  joinChannelByID = async (uniqueChannelId) => {\r\n    return new Promise(async (resolve, reject) => {\r\n      try {\r\n        this.unSubscribeChannel();\r\n        if (!this.client) return alert(\"Twilio loading\");\r\n\r\n        this.handler({\r\n          type: MessagingActionType.UPDATE_MESSAGING_DETAILS,\r\n          payload: { isLoading: true },\r\n        });\r\n\r\n        this.log(`Attempting to join ${uniqueChannelId} channel`);\r\n\r\n        const channel = await this.client.getChannelByUniqueName(\r\n          uniqueChannelId\r\n        );\r\n        await this.joinChannel(channel);\r\n\r\n        await this.onChanelJoined(channel);\r\n\r\n        this.log(`Channel joined`);\r\n\r\n        this.activeChannel = channel;\r\n\r\n        // LISTEN ON CHANNEL MESSAGE ADDED\r\n\r\n        channel.on(\"messageAdded\", async (message) => {\r\n          await this.onMessagedAdded(message);\r\n        });\r\n\r\n        // LISTEN FOR PERSON WHOSE ARE TYPING\r\n        channel.on(\"typingStarted\", (participant) => {\r\n          this.onParticipantStartTyping(participant);\r\n        });\r\n\r\n        // LISTEN FOR PERSON WHOM HAVE STOP TYPING\r\n        channel.on(\"typingEnded\", (participant) => {\r\n          this.onParticipantEndedTyping(participant);\r\n        });\r\n\r\n        // WHEN A MEMBER JOINED\r\n\r\n        channel.on(\"memberJoined\", (member) => {\r\n          this.onMemberJoined(member);\r\n        });\r\n\r\n        // WHEN A MEMBER LEFT\r\n        channel.on(\"memberLeft\", (member) => {\r\n          this.onMemberLeft(member);\r\n        });\r\n\r\n        this.handler({\r\n          type: MessagingActionType.UPDATE_CHANNEL_DETAILS,\r\n          payload: channel,\r\n        });\r\n        resolve(true);\r\n      } catch (err) {\r\n        this.log(`Not able to join the channel`);\r\n        reject(err);\r\n      }\r\n    });\r\n  };\r\n\r\n  joinChannel = async (channel) => {\r\n    if (channel.channelState.status !== \"joined\") {\r\n      await channel.join();\r\n    }\r\n  };\r\n\r\n  // FUNC FIRES WHEN USER JOINED IN A CHANNEL\r\n\r\n  onChanelJoined = async (channel) => {\r\n    const messages = await channel.getMessages();\r\n\r\n    let tempMessage = messages.items || [];\r\n\r\n    this.handler({\r\n      type: MessagingActionType.UPDATE_MESSAGING_DETAILS,\r\n      payload: {\r\n        activeChannelMessages: [...tempMessage],\r\n        isLoading: false,\r\n      },\r\n    });\r\n  };\r\n\r\n  // FUNC FIRES WHEN USER RECIVES MESSAGE\r\n\r\n  onMessagedAdded = (message) => {\r\n    const { channel } = message;\r\n    if (channel.sid !== this.activeChannel.sid) {\r\n      console.log(message, \"msg\", \"diff channel\");\r\n      return {};\r\n    } else {\r\n      return this.handler({\r\n        type: MessagingActionType.UPDATE_MESSAGE_DETAILS,\r\n        payload: message,\r\n      });\r\n    }\r\n  };\r\n\r\n  // WHEN PERSON STARTS TYPING THIS FUNC FIRES\r\n\r\n  onParticipantStartTyping = (participant) => {\r\n    let payload = {\r\n      type: \"typingStarted\",\r\n      participant,\r\n    };\r\n    updatePersonTyping(payload)(this.handler, this.getState);\r\n  };\r\n\r\n  // WHEN PERSON STOPS TYPING THIS FUNC FIRES\r\n\r\n  onParticipantEndedTyping = (participant) => {\r\n    let payload = {\r\n      type: \"typingEnded\",\r\n      participant,\r\n    };\r\n    updatePersonTyping(payload)(this.handler, this.getState);\r\n  };\r\n\r\n  // WHEN NEW PERSON JOINS THE ROOM THIS FUNC FIRES\r\n\r\n  onMemberJoined = (member) => {\r\n    const { state } = member;\r\n\r\n    const { identity } = state;\r\n\r\n    this.log(`${identity} has joined the chat`);\r\n\r\n    return this.handler({\r\n      type: MessagingActionType.UPDATE_MESSAGING_DETAILS,\r\n      payload: {\r\n        status: `${identity} has joined the chat`,\r\n      },\r\n    });\r\n  };\r\n\r\n  // WHEN A PERSON LEFT THE ROOM THIS FUNC FIRES\r\n\r\n  onMemberLeft = (member) => {\r\n    const { state } = member;\r\n\r\n    const { identity } = state;\r\n\r\n    this.log(`${identity} has left the chat`);\r\n\r\n    return this.handler({\r\n      type: MessagingActionType.UPDATE_MESSAGING_DETAILS,\r\n      payload: {\r\n        status: `${identity} has left the chat`,\r\n      },\r\n    });\r\n  };\r\n\r\n  getToken = () => {\r\n    const { getIdentityToken } = twilioApi;\r\n\r\n    getIdentityToken.id = localStorage.getItem(\"user-id\");\r\n\r\n    return new Promise((resolve, reject) => {\r\n      api({ ...getIdentityToken })\r\n        .then(({ chatToken }) => {\r\n          //   console.log(chatToken);\r\n          resolve(chatToken);\r\n        })\r\n        .catch((err) => {\r\n          Toast({ type: \"error\", message: err.message || \"Error\" });\r\n          reject(err);\r\n        });\r\n    });\r\n  };\r\n\r\n  // REMOVE THE LISTENERS FROM THE ACTIVE CHANNEL\r\n\r\n  unSubscribeChannel() {\r\n    if (this.activeChannel) {\r\n      this.activeChannel.removeAllListeners();\r\n      this.activeChannel = null;\r\n      this.log(\"Un subscribed from the channel\");\r\n    }\r\n    resetChannelDetails()(this.handler);\r\n  }\r\n\r\n  // REMOVE CHAT CLIENT\r\n\r\n  removeChatClient() {\r\n    if (this.client) {\r\n      this.client.removeAllListeners();\r\n      this.client = null;\r\n      this.handler({\r\n        type: MessagingActionType.UPDATE_MESSAGING_DETAILS,\r\n        payload: { clientData: null },\r\n      });\r\n      this.unSubscribeChannel();\r\n      this.log(\"chat client removed\");\r\n    }\r\n  }\r\n\r\n  log(message) {\r\n    console.log(`---------${message}------`);\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\n\r\nimport LocationIcon from \"../../../assets/files/TrainerDashboard/Message/Location Icon.svg\";\r\nimport SheduleIcon from \"../../../assets/files/TrainerDashboard/Message/Shedule Icon.svg\";\r\nimport AvailabilityIcon from \"../../../assets/files/TrainerDashboard/Message/Availability Icon.svg\";\r\nimport BlueHoverButton from \"../BlueArrowButton\";\r\n\r\nimport { ChatItem } from \"./ChatItem\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { trainerChannel } from \"action/trainerAct\";\r\nimport { connect } from \"react-redux\";\r\nimport { getFormatDate } from \"service/helperFunctions\";\r\n\r\nclass ChatBoxClass extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.messagesEndRef = React.createRef();\r\n    this.state = {\r\n      message: \"\",\r\n    };\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    // console.log(this.props, prevProps);\r\n    if (\r\n      this.props.activeChannelMessages.length !==\r\n      prevProps.activeChannelMessages.length\r\n    ) {\r\n      this.scrollToMessageListBottom();\r\n      console.log(\"hrllo\");\r\n    }\r\n    if (this.props.isLoading === false && prevProps.isLoading === true) {\r\n      setTimeout(() => {\r\n        this.scrollToMessageListBottom();\r\n        console.log(\"hrllo\", this.props.isLoading, prevProps.isLoading);\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.scrollToMessageListBottom();\r\n  }\r\n\r\n  scrollToMessageListBottom = () => {\r\n    this.messagesEndRef.current?.scrollTo(\r\n      0,\r\n      this.messagesEndRef.current?.scrollHeight\r\n    );\r\n  };\r\n\r\n  handleChange = ({ target: { value } }) => {\r\n    const { activeChannel } = this.props;\r\n\r\n    this.setState({\r\n      message: value,\r\n    });\r\n    activeChannel && activeChannel.typing();\r\n  };\r\n\r\n  handleSendMessage = (e) => {\r\n    e.preventDefault();\r\n    const { message } = this.state;\r\n\r\n    const { activeChannel } = this.props;\r\n\r\n    if (!activeChannel) {\r\n      return console.log(\"Chat Service is not configured.\");\r\n    }\r\n\r\n    if (activeChannel) {\r\n      activeChannel.sendMessage(String(message)).then(() => {\r\n        this.setState({\r\n          message: \"\",\r\n        });\r\n        this.scrollToMessageListBottom();\r\n      });\r\n    }\r\n  };\r\n\r\n  formatMessage = (messages = []) => {\r\n    var lastMsgDate = \"\";\r\n    let formattedMessage = messages.reduce((prevMsgArray, currMsg) => {\r\n      let tempPrevMsgArray = [...prevMsgArray];\r\n\r\n      const { timestamp } = currMsg.state;\r\n\r\n      let currYear = getFormatDate(null, \"YYYY\");\r\n\r\n      let msgYear = getFormatDate(timestamp, \"YYYY\");\r\n\r\n      let tempMsgDate = getFormatDate(timestamp, \"MMMM DD\");\r\n\r\n      let msgDate =\r\n        currYear === msgYear ? tempMsgDate : `${tempMsgDate}, ${msgYear}`;\r\n\r\n      if (lastMsgDate === msgDate) {\r\n        tempPrevMsgArray = [\r\n          ...tempPrevMsgArray,\r\n          { type: \"message\", ...currMsg },\r\n        ];\r\n      } else {\r\n        lastMsgDate = msgDate;\r\n        tempPrevMsgArray = [\r\n          ...tempPrevMsgArray,\r\n          { type: \"timestamp\", date: msgDate },\r\n          { type: \"message\", ...currMsg },\r\n        ];\r\n      }\r\n\r\n      return tempPrevMsgArray;\r\n    }, []);\r\n\r\n    return formattedMessage;\r\n  };\r\n  render() {\r\n    const {\r\n      activeChannelMessages = [],\r\n      typingMembers = [],\r\n      currentChannelMembers = [],\r\n      isLoading = false,\r\n      activeChannel = {},\r\n      channelData = {},\r\n      isDataPresent = false,\r\n    } = this.props;\r\n\r\n    const { message } = this.state;\r\n\r\n    const tempMsg = this.formatMessage(activeChannelMessages);\r\n\r\n    const messages = activeChannelMessages;\r\n\r\n    if (!isDataPresent) return null;\r\n    return (\r\n      <div className=\"message_right_chatarea\">\r\n        {activeChannel?.sid ? (\r\n          <>\r\n            {!isLoading ? (\r\n              <>\r\n                <div className=\"message_right_header\">\r\n                  <h2>{channelData?.chatTitle || \"Title\"}</h2>\r\n                  <div className=\"message_header_times\">\r\n                    <div className=\"message_header_items\">\r\n                      <img src={SheduleIcon} alt=\"icon\" />\r\n                      <h5>\r\n                        {\" \"}\r\n                        {new Date(channelData?.startTime).toDateString()}\r\n                      </h5>\r\n                    </div>\r\n                    <div className=\"message_header_items\">\r\n                      <img src={AvailabilityIcon} alt=\"icon\" />\r\n                      <h5>\r\n                        {new Date(channelData?.startTime).toLocaleTimeString()}\r\n                      </h5>\r\n                    </div>\r\n                    <div className=\"message_header_items\">\r\n                      <img src={LocationIcon} alt=\"icon\" />\r\n                      <h5>{channelData?.venue}</h5>\r\n                    </div>\r\n                  </div>\r\n                  <p>\r\n                    {typingMembers.length > 0 && (\r\n                      <span className=\"ml-auto text-primary fw-600\">{`${typingMembers.toString()} ${\r\n                        typingMembers.length > 1 ? \"are\" : \"is\"\r\n                      } typing...`}</span>\r\n                    )}\r\n                  </p>\r\n                </div>\r\n                <div\r\n                  className=\"message_right_textarea\"\r\n                  ref={this.messagesEndRef}\r\n                >\r\n                  {tempMsg?.length > 0 ? (\r\n                    tempMsg.map((item, index) => {\r\n                      return (\r\n                        <ChatItem\r\n                          item={item}\r\n                          currentChannelMembers={currentChannelMembers}\r\n                          key={`${Date.now()}_${index}`}\r\n                          currMsg={item}\r\n                        />\r\n                      );\r\n                    })\r\n                  ) : (\r\n                    <div className=\"w-100 h-100 d-flex align-items-center justify-content-center\">\r\n                      <span className=\"info-badge\">No message</span>\r\n                    </div>\r\n                  )}\r\n                  <div id=\"end-message\" />\r\n                </div>\r\n                <form className=\"w-100\" onSubmit={this.handleSendMessage}>\r\n                  <div className=\"message_right_input\">\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Type your message here..\"\r\n                      value={message}\r\n                      onChange={this.handleChange}\r\n                    />\r\n                    <div className=\"submit-btn-block\">\r\n                      <button className=\"transparent-btn\">\r\n                        <BlueHoverButton />\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </form>\r\n              </>\r\n            ) : (\r\n              <div className=\"w-100 h-100 d-flex align-items-center justify-content-center\">\r\n                <span className=\"info-badge\">{`${\r\n                  isLoading ? \"Loading...\" : \"Connecting...\"\r\n                }`}</span>\r\n              </div>\r\n            )}\r\n          </>\r\n        ) : (\r\n          <div className=\"w-100 h-100 d-flex align-items-center justify-content-center\">\r\n            <span className=\"info-badge\">{`${\r\n              isLoading ? \"Loading...\" : \"Select a chat to start messaging\"\r\n            }`}</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  clientData: state.messagingReducer.clientData,\r\n  activeChannel: state.messagingReducer.activeChannel,\r\n  activeChannelMessages: state.messagingReducer.activeChannelMessages,\r\n  typingMembers: state.messagingReducer.typingMembers,\r\n  chatClientInstance: state.messagingReducer.chatClientInstance,\r\n  currentChannelMembers: state.messagingReducer.currentChannelMembers,\r\n  isLoading: state.messagingReducer.isLoading,\r\n  channelData: state.messagingReducer.channelData,\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return bindActionCreators(\r\n    {\r\n      trainerChannel,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nconst ChatBox = connect(mapStateToProps, mapDispatchToProps)(ChatBoxClass);\r\n\r\nexport default ChatBox;\r\n","export default __webpack_public_path__ + \"static/media/Jenny.c50273b9.png\";","export default __webpack_public_path__ + \"static/media/Availability Icon.ad0517cb.svg\";","export default __webpack_public_path__ + \"static/media/Location Icon.cbb0b32d.svg\";","export default __webpack_public_path__ + \"static/media/Image 1.5667afc3.png\";","export default __webpack_public_path__ + \"static/media/Shedule Icon.7b9fb7aa.svg\";"],"sourceRoot":""}