{"version":3,"sources":["component/common/Message/ChatItem.js","component/common/Message/ChatBox.js","assets/files/TrainerDashboard/Message/Availability Icon.svg","assets/files/TrainerDashboard/Message/Location Icon.svg","assets/files/TrainerDashboard/Message/Image 1.png","assets/files/TrainerDashboard/Message/Shedule Icon.svg"],"names":["ChatItem","CurrentMessageComponent","currentChannelMembers","currMsg","type","state","date","msgTime","moment","timestamp","format","isMyMsg","author","localStorage","getItem","currentChatItemOwner","filter","userIdenity","className","body","ChatBoxClass","props","scrollToMessageListBottom","messagesEndRef","current","scrollTo","scrollHeight","handleChange","value","target","activeChannel","setState","message","typing","handleSendMessage","e","preventDefault","console","log","sendMessage","String","then","formatMessage","messages","lastMsgDate","formattedMessage","reduce","prevMsgArray","tempPrevMsgArray","currYear","getFormatDate","msgYear","tempMsgDate","msgDate","React","createRef","prevProps","this","activeChannelMessages","length","isLoading","setTimeout","typingMembers","channelData","isDataPresent","tempMsg","sid","chatTitle","src","SheduleIcon","alt","startTime","AvailabilityIcon","LocationIcon","venue","toString","ref","map","item","index","Date","now","id","onSubmit","placeholder","onChange","Component","ChatBox","connect","clientData","messagingReducer","chatClientInstance","dispatch","bindActionCreators","trainerChannel"],"mappings":"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","file":"static/js/125.8febb4be.chunk.js","sourcesContent":["import React from \"react\";\r\nimport moment from \"moment\";\r\n\r\nimport Jonn from \"../../../assets/files/TrainerDashboard/Message/Image 1.png\";\r\nimport { UserAvatar } from \"../UserAvatar\";\r\n\r\nexport const ChatItem = ({\r\n  currentChannelMembers = [],\r\n  currMsg: { type, state, date },\r\n}) => {\r\n  let CurrentMessageComponent;\r\n\r\n  if (type === \"message\") {\r\n    let msgCreatedDate = moment(state.timestamp);\r\n\r\n    let msgTime = msgCreatedDate.format(\"LT\");\r\n\r\n    const isMyMsg = state?.author === localStorage.getItem(\"user-id\");\r\n\r\n    const currentChatItemOwner =\r\n      currentChannelMembers.filter(\r\n        ({ userIdenity }) => userIdenity === state.author\r\n      )[0] || {};\r\n\r\n    CurrentMessageComponent = (\r\n      <div className={`message_chat_${isMyMsg ? \"right\" : \"left\"}`}>\r\n        <div className=\"message_text\">\r\n          <h5>{state?.body || \"\"}</h5>\r\n          <span className=\"msg-time\">{msgTime}</span>\r\n        </div>\r\n\r\n        <UserAvatar {...currentChatItemOwner} />\r\n\r\n        {/* <img\r\n          src={currentChatItemOwner?.profilePicture || Jonn}\r\n          alt=\"icon\"\r\n          onError={(e) => {\r\n            e.target.onerror = null;\r\n            e.target.src = Jonn;\r\n          }}\r\n        /> */}\r\n      </div>\r\n    );\r\n  } else {\r\n    CurrentMessageComponent = (\r\n      <div className=\"w-100 d-flex align-items-center justify-content-center my-3\">\r\n        <span className=\"info-badge\">{date}</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return <div>{CurrentMessageComponent}</div>;\r\n};\r\n","import React, { Component } from \"react\";\r\n\r\nimport LocationIcon from \"../../../assets/files/TrainerDashboard/Message/Location Icon.svg\";\r\nimport SheduleIcon from \"../../../assets/files/TrainerDashboard/Message/Shedule Icon.svg\";\r\nimport AvailabilityIcon from \"../../../assets/files/TrainerDashboard/Message/Availability Icon.svg\";\r\nimport BlueHoverButton from \"../BlueArrowButton\";\r\n\r\nimport { ChatItem } from \"./ChatItem\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { trainerChannel } from \"action/trainerAct\";\r\nimport { connect } from \"react-redux\";\r\nimport { getFormatDate } from \"service/helperFunctions\";\r\n\r\nclass ChatBoxClass extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.messagesEndRef = React.createRef();\r\n    this.state = {\r\n      message: \"\",\r\n    };\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    // console.log(this.props, prevProps);\r\n    if (\r\n      this.props.activeChannelMessages.length !==\r\n      prevProps.activeChannelMessages.length\r\n    ) {\r\n      this.scrollToMessageListBottom();\r\n      // console.log(\"hrllo\");\r\n    }\r\n    if (this.props.isLoading === false && prevProps.isLoading === true) {\r\n      setTimeout(() => {\r\n        this.scrollToMessageListBottom();\r\n        // console.log(\"hrllo\", this.props.isLoading, prevProps.isLoading);\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.scrollToMessageListBottom();\r\n  }\r\n\r\n  scrollToMessageListBottom = () => {\r\n    this.messagesEndRef.current?.scrollTo(\r\n      0,\r\n      this.messagesEndRef.current?.scrollHeight\r\n    );\r\n  };\r\n\r\n  handleChange = ({ target: { value } }) => {\r\n    const { activeChannel } = this.props;\r\n\r\n    this.setState({\r\n      message: value,\r\n    });\r\n    activeChannel && activeChannel.typing();\r\n  };\r\n\r\n  handleSendMessage = (e) => {\r\n    e.preventDefault();\r\n    const { message } = this.state;\r\n\r\n    const { activeChannel } = this.props;\r\n\r\n    if (!activeChannel) {\r\n      return console.log(\"Chat Service is not configured.\");\r\n    }\r\n\r\n    if (activeChannel) {\r\n      activeChannel.sendMessage(String(message)).then(() => {\r\n        this.setState({\r\n          message: \"\",\r\n        });\r\n        this.scrollToMessageListBottom();\r\n      });\r\n    }\r\n  };\r\n\r\n  formatMessage = (messages = []) => {\r\n    var lastMsgDate = \"\";\r\n    let formattedMessage = messages.reduce((prevMsgArray, currMsg) => {\r\n      let tempPrevMsgArray = [...prevMsgArray];\r\n\r\n      const { timestamp } = currMsg.state;\r\n\r\n      let currYear = getFormatDate(null, \"YYYY\");\r\n\r\n      let msgYear = getFormatDate(timestamp, \"YYYY\");\r\n\r\n      let tempMsgDate = getFormatDate(timestamp, \"MMMM DD\");\r\n\r\n      let msgDate =\r\n        currYear === msgYear ? tempMsgDate : `${tempMsgDate}, ${msgYear}`;\r\n\r\n      if (lastMsgDate === msgDate) {\r\n        tempPrevMsgArray = [\r\n          ...tempPrevMsgArray,\r\n          { type: \"message\", ...currMsg },\r\n        ];\r\n      } else {\r\n        lastMsgDate = msgDate;\r\n        tempPrevMsgArray = [\r\n          ...tempPrevMsgArray,\r\n          { type: \"timestamp\", date: msgDate },\r\n          { type: \"message\", ...currMsg },\r\n        ];\r\n      }\r\n\r\n      return tempPrevMsgArray;\r\n    }, []);\r\n\r\n    return formattedMessage;\r\n  };\r\n  render() {\r\n    const {\r\n      activeChannelMessages = [],\r\n      typingMembers = [],\r\n      currentChannelMembers = [],\r\n      isLoading = false,\r\n      activeChannel = {},\r\n      channelData = {},\r\n      isDataPresent = false,\r\n    } = this.props;\r\n\r\n    const { message } = this.state;\r\n\r\n    const tempMsg = this.formatMessage(activeChannelMessages);\r\n\r\n    const messages = activeChannelMessages;\r\n\r\n    if (!isDataPresent)\r\n      return (\r\n        <div className=\"w-100 h-100 d-flex align-items-center justify-content-center\">\r\n          {!isLoading ? <h3>No People</h3> : \"\"}\r\n        </div>\r\n      );\r\n    return (\r\n      <div className=\"message_right_chatarea\">\r\n        {activeChannel?.sid ? (\r\n          <>\r\n            {!isLoading ? (\r\n              <>\r\n                <div className=\"message_right_header\">\r\n                  <h2>{channelData?.chatTitle || \"Title\"}</h2>\r\n                  <div className=\"message_header_times\">\r\n                    <div className=\"message_header_items\">\r\n                      <img src={SheduleIcon} alt=\"icon\" />\r\n                      <h5>\r\n                        {getFormatDate(\r\n                          channelData?.startTime,\r\n                          \"ddd MMM DD YYYY\",\r\n                          true\r\n                        )}\r\n                      </h5>\r\n                    </div>\r\n                    <div className=\"message_header_items\">\r\n                      <img src={AvailabilityIcon} alt=\"icon\" />\r\n                      <h5>\r\n                        {getFormatDate(channelData?.startTime, \"hh:mm A\", true)}\r\n                      </h5>\r\n                    </div>\r\n                    <div className=\"message_header_items\">\r\n                      <img src={LocationIcon} alt=\"icon\" />\r\n                      <h5>{channelData?.venue}</h5>\r\n                    </div>\r\n                  </div>\r\n                  <p>\r\n                    {typingMembers.length > 0 && (\r\n                      <span className=\"ml-auto text-primary fw-600\">{`${typingMembers.toString()} ${\r\n                        typingMembers.length > 1 ? \"are\" : \"is\"\r\n                      } typing...`}</span>\r\n                    )}\r\n                  </p>\r\n                </div>\r\n                <div\r\n                  className=\"message_right_textarea\"\r\n                  ref={this.messagesEndRef}\r\n                >\r\n                  {tempMsg?.length > 0 ? (\r\n                    tempMsg.map((item, index) => {\r\n                      return (\r\n                        <ChatItem\r\n                          item={item}\r\n                          currentChannelMembers={currentChannelMembers}\r\n                          key={`${Date.now()}_${index}`}\r\n                          currMsg={item}\r\n                        />\r\n                      );\r\n                    })\r\n                  ) : (\r\n                    <div className=\"w-100 h-100 d-flex align-items-center justify-content-center\">\r\n                      <span className=\"info-badge\">No message</span>\r\n                    </div>\r\n                  )}\r\n                  <div id=\"end-message\" />\r\n                </div>\r\n                <form className=\"w-100\" onSubmit={this.handleSendMessage}>\r\n                  <div className=\"message_right_input\">\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Type your message here..\"\r\n                      value={message}\r\n                      onChange={this.handleChange}\r\n                    />\r\n                    <div className=\"submit-btn-block\">\r\n                      <button className=\"transparent-btn\">\r\n                        <BlueHoverButton />\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </form>\r\n              </>\r\n            ) : (\r\n              <div className=\"w-100 h-100 d-flex align-items-center justify-content-center\">\r\n                <span className=\"info-badge\">{`${\r\n                  isLoading ? \"Loading...\" : \"Connecting...\"\r\n                }`}</span>\r\n              </div>\r\n            )}\r\n          </>\r\n        ) : (\r\n          <div className=\"w-100 h-100 d-flex align-items-center justify-content-center\">\r\n            <span className=\"info-badge\">{`${\r\n              isLoading ? \"Loading...\" : \"Select a chat to start messaging\"\r\n            }`}</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  clientData: state.messagingReducer.clientData,\r\n  activeChannel: state.messagingReducer.activeChannel,\r\n  activeChannelMessages: state.messagingReducer.activeChannelMessages,\r\n  typingMembers: state.messagingReducer.typingMembers,\r\n  chatClientInstance: state.messagingReducer.chatClientInstance,\r\n  currentChannelMembers: state.messagingReducer.currentChannelMembers,\r\n  isLoading: state.messagingReducer.isLoading,\r\n  channelData: state.messagingReducer.channelData,\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return bindActionCreators(\r\n    {\r\n      trainerChannel,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nconst ChatBox = connect(mapStateToProps, mapDispatchToProps)(ChatBoxClass);\r\n\r\nexport default ChatBox;\r\n","export default __webpack_public_path__ + \"static/media/Availability Icon.ad0517cb.svg\";","export default __webpack_public_path__ + \"static/media/Location Icon.cbb0b32d.svg\";","export default __webpack_public_path__ + \"static/media/Image 1.5667afc3.png\";","export default __webpack_public_path__ + \"static/media/Shedule Icon.7b9fb7aa.svg\";"],"sourceRoot":""}