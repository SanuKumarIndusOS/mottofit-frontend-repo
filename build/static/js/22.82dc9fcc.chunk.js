(this.webpackJsonpmotto=this.webpackJsonpmotto||[]).push([[22,83,105,136,142,161,174,236,370,371,372,464,465],{1053:function(e,t){},1066:function(e,t){},164:function(e,t,n){"use strict";n.r(t),n.d(t,"InfiniteScrollComponent",(function(){return b}));var a=n(4),s=n(12),i=n.n(s),c=n(26),r=n(19),o=n(20),l=n(25),u=n(24),d=n(2),h=n(67),g=n(306),m=n(1),b=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).toggleContent=function(e){var t=parseInt(e),n=a.state,s=n.showContent,i=(n.isMobile,s===t?"":t);a.setState({showContent:i},(function(){}))},a.handleAboutToReachBottom=Object(c.a)(i.a.mark((function e(){var t,n,s,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.isLoading,s=t.page,c=a.props.handleApi,a.setState({isLoading:!0}),!1!==n){e.next=9;break}return e.next=6,c(s+1);case 6:r=e.sent,r.data,a.setState({page:s+1,isLoading:!1});case 9:case"end":return e.stop()}}),e)}))),a.handleUpdate=function(e){var t=e.scrollTop,n=e.scrollHeight,s=e.clientHeight,i=a.state,c=i.isLoading,r=i.total,o=i.currentDataSize;(t+100)/(n-s)>1&&o<r&&!1===c&&a.handleAboutToReachBottom()},a.loader=function(){return Object(m.jsx)("div",{className:"d-flex flex-column align-items-center justify-content-center w-100 pt-3",children:Object(m.jsx)(h.CommonPageLoader,{})})},a.state={showContent:"",page:0,count:0,total:0,isMobile:!1,isLoading:!1,notificationData:[],currentDataSize:0,initialLoad:!0},a.refArray=[],a}return Object(o.a)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props.totalSize,n=this.state,a=n.initialLoad,s=n.currentDataSize;!a&&0===s&&t!==e.totalSize&&t>0&&(this.setState({currentDataSize:s,initialLoad:!0,total:t}),console.log("Runned"))}},{key:"componentDidMount",value:function(){var e=this.props,t=e.currentDataSize,n=e.totalSize;window.matchMedia("(max-width: 700px)").matches&&this.setState({isMobile:!0}),t>0?this.setState({total:n}):this.setState({initialLoad:!1})}},{key:"render",value:function(){var e=this.state,t=(e.showContent,e.total),n=e.isMobile,s=e.isLoading,i=(e.notificationData,e.initialLoad),c=n?{style:{height:550}}:{style:{height:500}},r={};return e.currentDataSize<t&&(r.onUpdate=this.handleUpdate),Object(m.jsx)("div",{className:"notification-page",children:Object(m.jsx)("div",{className:"notification-page-body",children:i?Object(m.jsxs)(g.CustomScrollbar,Object(a.a)(Object(a.a)(Object(a.a)({customStyle:{width:"12px",right:"5px"}},c),r),{},{children:[this.props.children,s&&this.loader()]})):Object(m.jsx)(h.CommonPageLoader,{className:"mt-5 pt-5"})})})}}]),n}(d.Component)},181:function(e,t,n){"use strict";n.r(t);var a=n(4),s=n(32),i=n(92),c=n(11),r=n(2),o=n(795),l=(n(792),n(611),n(428),n(433),n(449),n(427),n(430),n(57),n(66)),u=n(27),d=n(23),h=(n(9),n(94),n(35)),g=(n(297),n(301)),m=(n(93),n(43),n(67),n(164),n(5)),b=n(325),j=n(18),p=n(1),f=Object(u.b)((function(e){return{clientData:e.messagingReducer.clientData,activeChannel:e.messagingReducer.activeChannel,activeChannelMessages:e.messagingReducer.activeChannelMessages,typingMembers:e.messagingReducer.typingMembers,chatClientInstance:e.messagingReducer.chatClientInstance,pastSessions:e.messagingReducer.pastSessions,upcomingSessions:e.messagingReducer.upcomingSessions,requestedSessions:e.messagingReducer.requestedSessions,adminMessages:e.messagingReducer.adminMessages,userMessages:e.messagingReducer.userMessages,trainerMessages:e.messagingReducer.trainerMessages,invitedSessions:e.messagingReducer.invitedSessions}}),(function(e){return Object(d.b)({trainerChannel:l.trainerChannel,adminChannel:l.adminChannel,initClientDispatch:g.initClientDispatch,updateMessagingDetails:g.updateMessagingDetails,unSubscribeAct:g.unSubscribeFromChannel,unSubscribeClientAct:g.unSubscribeFromClient},e)}))((function(e){var t=e.trainerChannel,n=e.adminChannel,l=e.initClientDispatch,u=(e.clientData,e.activeChannel,e.activeChannelMessages,e.typingMembers,e.chatClientInstance),d=e.updateMessagingDetails,g=e.pastSessions,f=e.upcomingSessions,v=e.requestedSessions,O=e.adminMessages,y=e.userMessages,x=e.trainerMessages,S=e.invitedSessions,M=e.unSubscribeAct,C=e.unSubscribeClientAct,T=3===parseInt(localStorage.getItem("type")),D=1===parseInt(localStorage.getItem("type")),A=Object(j.h)().type,I=Object(r.useState)([]),_=Object(c.a)(I,2),L=(_[0],_[1],Object(r.useState)([])),N=Object(c.a)(L,2),E=(N[0],N[1],Object(r.useState)([])),w=Object(c.a)(E,2),k=(w[0],w[1],Object(r.useState)([])),P=Object(c.a)(k,2),R=(P[0],P[1],Object(r.useState)()),U=Object(c.a)(R,2),F=(U[0],U[1],Object(r.useState)([])),G=Object(c.a)(F,2),B=(G[0],G[1],Object(r.useState)([])),q=Object(c.a)(B,2),Y=(q[0],q[1],Object(r.useState)("")),z=Object(c.a)(Y,2),J=(z[0],z[1],Object(r.useState)("")),H=Object(c.a)(J,2),V=(H[0],H[1],Object(r.useState)(!0)),Z=Object(c.a)(V,2),K=Z[0],Q=Z[1],W=Object(r.useState)({invited:0,upcoming:0,past:0,admin:0}),X=Object(c.a)(W,2),$=X[0],ee=(X[1],Object(r.useState)(D?"trainer":"upcoming")),te=Object(c.a)(ee,2),ne=te[0],ae=te[1];Object(r.useEffect)((function(){window.scrollTo(0,0);var e=m.history.location.search,t=(e.split("=")[1],e.split("channelId=")[1]),n=window.matchMedia("(max-width: 700px)");return l(t,(function(){Q(!1)})),function(){n.matches||C()}}),[]),Object(r.useEffect)((function(){var e=m.history.location.search;e.split("=")[1],e.split("channelId=")[1];A&&ae(A)}),[m.history.location]),Object(r.useEffect)((function(){se(ne)}),[$]);var se=function(e){if(D)return ie();t(e,$[e]).then((function(t){var n={invited:"invitedSessions",upcoming:"upcomingSessions",past:"pastSessions",admin:"adminMessages",requested:"requestedSessions"}[e];Q(!1);var a=Object(s.a)({},n,Object(i.a)(t));d(a)})).catch((function(e){Q(!1)}))},ie=function(){n().then((function(e){var t=e||{},n=t.trainersArray,s=void 0===n?[]:n,c=t.usersArray,r=void 0===c?[]:c,o=m.history.location.search,l={userMessages:Object(i.a)(r),trainerMessages:Object(i.a)(s)};Q(!1);var u=o.split("channelId=")[1];if(u){var h=l[{trainer:"trainerMessages",user:"userMessages"}[A]].filter((function(e){return e.channelId===u}))[0]||{};l=Object(a.a)(Object(a.a)({},l),{},{currentChannelMembers:null===h||void 0===h?void 0:h.members,channelData:h})}d(l)})).catch((function(e){console.log(e),Object(h.Toast)({type:"error",message:e.message||"Error"})}))};function ce(e,t,n){var a=window.matchMedia("(max-width: 700px)");u.joinChannelByID(e).then((function(){d({currentChannelMembers:t,channelData:n}),a.matches&&m.history.push("/mobiles/chat")})).catch((function(e){console.log(e)}))}return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("div",{className:"main_message_container",children:Object(p.jsxs)("div",{className:"message_outter_container",children:[Object(p.jsx)("h2",{children:"Messages"}),Object(p.jsx)("div",{className:"message_inner",children:Object(p.jsxs)("div",{className:"message_wrapper",children:[Object(p.jsxs)(o.d,{defaultTab:ne,onChange:function(e){!function(e){var t=A;m.history.location.search,D?e!==t&&m.history.push("/admins/message/".concat(e)):e!==t&&m.history.push("/".concat(T?"user":"trainers","/dashboard/message/").concat(e)),ae(e),Q(!0),M(),se(e)}(e)},children:[Object(p.jsx)(o.b,{children:D?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.a,{tabFor:"trainer",children:"Trainers"}),Object(p.jsx)(o.a,{tabFor:"user",children:"Users"})]}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.a,{tabFor:"upcoming",children:"Upcoming"}),T&&Object(p.jsx)(o.a,{tabFor:"invited",children:"Invited"}),Object(p.jsx)(o.a,{tabFor:"past",children:"Previous"}),Object(p.jsx)(o.a,{tabFor:"admin",children:"Admin"}),Object(p.jsx)(o.a,{tabFor:"requested",children:"Requests"})]})}),Object(p.jsxs)("div",{className:"message_inner",children:[Object(p.jsx)(o.c,{tabId:"invited",children:Object(p.jsx)(b.MessageComponent,{isMessageListLoading:K,messageData:S,PopulateContacts:ce})}),Object(p.jsx)(o.c,{tabId:"upcoming",children:Object(p.jsx)(b.MessageComponent,{isMessageListLoading:K,messageData:f,PopulateContacts:ce})}),Object(p.jsx)(o.c,{tabId:"past",children:Object(p.jsx)(b.MessageComponent,{isMessageListLoading:K,messageData:g,PopulateContacts:ce})}),Object(p.jsx)(o.c,{tabId:"admin",children:Object(p.jsx)(b.MessageComponent,{isMessageListLoading:K,messageData:O,PopulateContacts:ce})}),Object(p.jsx)(o.c,{tabId:"requested",children:Object(p.jsx)(b.MessageComponent,{isMessageListLoading:K,messageData:v,PopulateContacts:ce})}),Object(p.jsx)(o.c,{tabId:"user",children:Object(p.jsx)(b.MessageComponent,{isMessageListLoading:K,messageData:y,PopulateContacts:ce})}),Object(p.jsx)(o.c,{tabId:"trainer",children:Object(p.jsx)(b.MessageComponent,{isMessageListLoading:K,messageData:x,PopulateContacts:ce})})]})]}),Object(p.jsx)("div",{className:""})]})})]})})})}));t.default=f},295:function(e,t,n){"use strict";n.r(t),n.d(t,"ChatItem",(function(){return o}));var a=n(4),s=(n(2),n(242)),i=n.n(s),c=(n(433),n(43)),r=n(1),o=function(e){var t,n=e.currentChannelMembers,s=void 0===n?[]:n,o=e.currMsg,l=o.type,u=o.state,d=o.date;if("message"===l){var h=i()(u.timestamp).format("LT"),g=(null===u||void 0===u?void 0:u.author)===localStorage.getItem("user-id"),m=s.filter((function(e){return e.userIdenity===u.author}))[0]||{};t=Object(r.jsxs)("div",{className:"message_chat_".concat(g?"right":"left"),children:[Object(r.jsxs)("div",{className:"message_text",children:[Object(r.jsx)("h5",{children:(null===u||void 0===u?void 0:u.body)||""}),Object(r.jsx)("span",{className:"msg-time",children:h})]}),Object(r.jsx)(c.UserAvatar,Object(a.a)({},m))]})}else t=Object(r.jsx)("div",{className:"w-100 d-flex align-items-center justify-content-center my-3",children:Object(r.jsx)("span",{className:"info-badge",children:d})});return Object(r.jsx)("div",{children:t})}},297:function(e,t,n){"use strict";n.r(t);var a=n(4),s=n(92),i=n(19),c=n(20),r=n(25),o=n(24),l=n(2),u=n.n(l),d=n(430),h=n(449),g=n(427),m=n(57),b=n(295),j=n(23),p=n(66),f=n(46),v=n(27),O=n(93),y=n(1),x=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){var c;return Object(i.a)(this,n),(c=t.call(this,e)).scrollToMessageListBottom=function(){var e,t;null===(e=c.messagesEndRef.current)||void 0===e||e.scrollTo(0,null===(t=c.messagesEndRef.current)||void 0===t?void 0:t.scrollHeight)},c.handleChange=function(e){var t=e.target.value,n=c.props.activeChannel;c.setState({message:t}),n&&n.typing()},c.handleSendMessage=function(e){e.preventDefault();var t=c.state.message,n=c.props.activeChannel;if(!n)return console.log("Chat Service is not configured.");n&&n.sendMessage(String(t)).then((function(){c.setState({message:""}),c.scrollToMessageListBottom()}))},c.formatMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t="",n=e.reduce((function(e,n){var i=Object(s.a)(e),c=n.state.timestamp,r=Object(O.getFormatDate)(null,"YYYY"),o=Object(O.getFormatDate)(c,"YYYY"),l=Object(O.getFormatDate)(c,"MMMM DD"),u=r===o?l:"".concat(l,", ").concat(o);return t===u?i=[].concat(Object(s.a)(i),[Object(a.a)({type:"message"},n)]):(t=u,i=[].concat(Object(s.a)(i),[{type:"timestamp",date:u},Object(a.a)({type:"message"},n)])),i}),[]);return n},c.unread=function(){var e=[];c.setState({members:c.props.currentChannelMembers},(function(){var t=c.state.members.filter((function(e){return e.memberIdenity!==localStorage.getItem("user-id")}));e=t.map((function(e){return e.userId})),c.props.send_unread_notification({recepients:e})}))},c.messagesEndRef=u.a.createRef(),c.state={message:"",members:[]},c}return Object(c.a)(n,[{key:"componentDidUpdate",value:function(e){var t=this;this.props.activeChannelMessages.length!==e.activeChannelMessages.length&&this.scrollToMessageListBottom(),!1===this.props.isLoading&&!0===e.isLoading&&setTimeout((function(){t.scrollToMessageListBottom()}),100)}},{key:"componentDidMount",value:function(){this.scrollToMessageListBottom()}},{key:"render",value:function(){var e=this.props,t=e.activeChannelMessages,n=void 0===t?[]:t,a=e.typingMembers,s=void 0===a?[]:a,i=e.currentChannelMembers,c=void 0===i?[]:i,r=e.isLoading,o=void 0!==r&&r,l=e.activeChannel,u=void 0===l?{}:l,j=e.channelData,p=void 0===j?{}:j,f=e.isDataPresent,v=void 0!==f&&f,x=this.state.message,S=this.formatMessage(n);return v?Object(y.jsx)("div",{className:"message_right_chatarea",children:(null===u||void 0===u?void 0:u.sid)?Object(y.jsx)(y.Fragment,{children:o?Object(y.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center",children:Object(y.jsx)("span",{className:"info-badge",children:"".concat(o?"Loading...":"Connecting...")})}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)("div",{className:"message_right_header",children:[Object(y.jsx)("h2",{children:(null===p||void 0===p?void 0:p.chatTitle)||"Title"}),Object(y.jsxs)("div",{className:"message_header_times",children:[Object(y.jsxs)("div",{className:"message_header_items",children:[Object(y.jsx)("img",{src:h.default,alt:"icon"}),Object(y.jsx)("h5",{children:Object(O.getFormatDate)(null===p||void 0===p?void 0:p.startTime,"ddd MMM DD YYYY",!0)})]}),Object(y.jsxs)("div",{className:"message_header_items",children:[Object(y.jsx)("img",{src:g.default,alt:"icon"}),Object(y.jsx)("h5",{children:Object(O.getFormatDate)(null===p||void 0===p?void 0:p.startTime,"hh:mm A",!0)})]}),Object(y.jsxs)("div",{className:"message_header_items",children:[Object(y.jsx)("img",{src:d.default,alt:"icon"}),Object(y.jsx)("h5",{children:null===p||void 0===p?void 0:p.venue})]})]}),Object(y.jsx)("p",{children:s.length>0&&Object(y.jsx)("span",{className:"ml-auto text-primary fw-600",children:"".concat(s.toString()," ").concat(s.length>1?"are":"is"," typing...")})})]}),Object(y.jsxs)("div",{className:"message_right_textarea",ref:this.messagesEndRef,children:[(null===S||void 0===S?void 0:S.length)>0?S.map((function(e,t){return Object(y.jsx)(b.ChatItem,{item:e,currentChannelMembers:c,currMsg:e},"".concat(Date.now(),"_").concat(t))})):Object(y.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center",children:Object(y.jsx)("span",{className:"info-badge",children:"No message"})}),Object(y.jsx)("div",{id:"end-message"})]}),Object(y.jsx)("form",{className:"w-100",onSubmit:this.handleSendMessage,children:Object(y.jsxs)("div",{className:"message_right_input",children:[Object(y.jsx)("input",{type:"text",placeholder:"Type your message here..",value:x,onChange:this.handleChange}),Object(y.jsx)("div",{className:"submit-btn-block",onClick:this.unread,children:Object(y.jsx)("button",{className:"transparent-btn",children:Object(y.jsx)(m.default,{})})})]})})]})}):Object(y.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center",children:Object(y.jsx)("span",{className:"info-badge",children:"".concat(o?"Loading...":"Select a chat to start messaging")})})}):Object(y.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center",children:o?"":Object(y.jsx)("h3",{children:"No New Messages"})})}}]),n}(l.Component),S=Object(v.b)((function(e){return{clientData:e.messagingReducer.clientData,activeChannel:e.messagingReducer.activeChannel,activeChannelMessages:e.messagingReducer.activeChannelMessages,typingMembers:e.messagingReducer.typingMembers,chatClientInstance:e.messagingReducer.chatClientInstance,currentChannelMembers:e.messagingReducer.currentChannelMembers,isLoading:e.messagingReducer.isLoading,channelData:e.messagingReducer.channelData}}),(function(e){return Object(j.b)({trainerChannel:p.trainerChannel,send_unread_notification:f.send_unread_notification},e)}))(x);t.default=S},301:function(e,t,n){"use strict";n.r(t),n.d(t,"updatePersonTyping",(function(){return r})),n.d(t,"resetChannelDetails",(function(){return o})),n.d(t,"updateMessagingDetails",(function(){return l})),n.d(t,"updateGlobalMessagingDetails",(function(){return u})),n.d(t,"initClientDispatch",(function(){return d})),n.d(t,"unSubscribeFromChannel",(function(){return h})),n.d(t,"unSubscribeFromClient",(function(){return g}));var a=n(4),s=n(92),i=n(17),c=n(311),r=function(e){return function(t,n){var a=n().messagingReducer,c=a.typingMembers,r=a.currentChannelMembers,o=e.type,l=e.participant.state.identity,u=c,d=(localStorage.getItem("user-id"),r.filter((function(e){return e.userIdenity===l}))[0]||{}),h=(null===d||void 0===d?void 0:d.userName)||l;"typingStarted"===o?c.includes(h)||(u=[].concat(Object(s.a)(c),[h]),t({type:i.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{typingMembers:Object(s.a)(u)}})):"typingEnded"===o&&c.includes(h)&&(u=Object(s.a)(c).filter((function(e){return e!==h})),t({type:i.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{typingMembers:Object(s.a)(u)}}))}},o=function(){return function(e){e({type:i.MessagingActionType.RESET_CHANNEL_DETAILS})}},l=function(e){return function(t){t({type:i.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:e})}},u=function(e){return function(t,n){var a,c,r,o,l=null===e||void 0===e||null===(a=e.channel)||void 0===a?void 0:a.sid,u=null===e||void 0===e||null===(c=e.state)||void 0===c?void 0:c.body,d=null===e||void 0===e||null===(r=e.state)||void 0===r?void 0:r.author,h=n().messagingReducer,g=h.pastSessions,b=h.upcomingSessions,j=h.adminMessages,p=h.invitedSessions,f=h.requestedSessions,v=h.userMessages,O=h.trainerMessages,y=Object(s.a)(g),x=Object(s.a)(b),S=Object(s.a)(p),M=Object(s.a)(j),C=Object(s.a)(f),T=Object(s.a)(v),D=Object(s.a)(O),A=m(y,l,u,d),I=m(x,l,u,d),_=m(C,l,u,d),L=m(S,l,u,d),N={pastSessions:A,upcomingSessions:I,requestedSessions:_,adminMessages:m(M,l,u,d),userMessages:m(T,l,u,d),trainerMessages:m(D,l,u,d),invitedSessions:L},E=document.getElementsByClassName("message_left");null===(o=Object(s.a)(E))||void 0===o||o.forEach((function(e){return null===e||void 0===e?void 0:e.scrollTo(0,0)})),t({type:i.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:N})}},d=function(e,t){return function(n,a){n({type:i.MessagingActionType.UPDATE_CLIENT_INSTANCE,payload:new c.default(n,a,e,t)})}},h=function(){return function(e,t){var n=t().messagingReducer.chatClientInstance;n&&n.unSubscribeChannel()}},g=function(){return function(e,t){var n=t().messagingReducer.chatClientInstance;n&&n.removeChatClient()}},m=function(e,t,n,i){var c=Object(s.a)(e).map((function(e){var s=Object(a.a)({},e);return(null===e||void 0===e?void 0:e.channelId)===t&&(Object.keys(s).includes("message")||(s.message={}),s.message.body=n,s.message.date_updated=(new Date).toISOString(),s.message.from=i),Object(a.a)({},s)}));return c=c.sort((function(e,t){var n,a;return new Date((null===t||void 0===t||null===(n=t.message)||void 0===n?void 0:n.date_updated)||1950)-new Date((null===e||void 0===e||null===(a=e.message)||void 0===a?void 0:a.date_updated)||1950)})),Object(s.a)(c)}},306:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomScrollbar",(function(){return g}));var a=n(4),s=n(50),i=n(19),c=n(20),r=n(25),o=n(24),l=n(2),u=n.n(l),d=n(1007),h=n(1),g=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(i.a)(this,n);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).scrollbars=u.a.createRef(),e.state={mounted:!1},e.renderThumb=function(t){var n=t.style,i=Object(s.a)(t,["style"]),c=e.props.customStyle,r=Object(a.a)({backgroundColor:"#f2f2f2",borderRadius:"8px",width:"16px"},c);return Object(h.jsx)("div",Object(a.a)(Object(a.a)({style:Object(a.a)(Object(a.a)({},n),r)},i),{},{className:"render-y"}))},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.setState({mounted:!0})}},{key:"componentDidUpdate",value:function(){var e=this.props.scrollToBottomUpdate;void 0!==e&&e&&this.state.mounted&&this.scrollbars.current.scrollToBottom()}},{key:"renderView",value:function(e){var t=e.style,n=Object(s.a)(e,["style"]);return Object(h.jsx)("div",Object(a.a)(Object(a.a)({style:Object(a.a)({},t)},n),{},{className:"h"}))}},{key:"render",value:function(){var e=this.props,t=(e.customStyle,Object(s.a)(e,["customStyle"]));return Object(h.jsx)(d.Scrollbars,Object(a.a)({ref:this.scrollbars,renderThumbHorizontal:this.renderThumb,renderThumbVertical:this.renderThumb,renderView:this.renderView},t))}}]),n}(l.Component)},311:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var a=n(4),s=n(92),i=n(12),c=n.n(i),r=n(26),o=n(19),l=n(20),u=n(17),d=n(9),h=n(94),g=n(35),m=n(301),b=n(1017),j=function(){function e(t,n,i,l){var j=this;Object(o.a)(this,e),this.initClient=Object(r.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getToken();case 2:return t=e.sent,e.next=5,b.Client.create(t);case 5:n=e.sent,j.client=n,j.handler({type:u.MessagingActionType.INITIALIZE_CLIENT,payload:n}),j.initClientListeners(n);case 9:case"end":return e.stop()}}),e)}))),this.initClientListeners=function(e){e.removeAllListeners(),e.on("messageAdded",function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j.globalMessage(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.on("typingStarted",(function(e){j.onParticipantStartTyping(e)})),e.on("typingEnded",(function(e){j.onParticipantEndedTyping(e)})),e.on("tokenAboutToExpire",Object(r.a)(c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j.log("token is about to expire"),t.next=3,j.getToken();case 3:n=t.sent,e.updateToken(n);case 5:case"end":return t.stop()}}),t)})))),e.on("tokenExpired",Object(r.a)(c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j.log("token is about to expire"),t.next=3,j.getToken();case 3:n=t.sent,e.updateToken(n);case 5:case"end":return t.stop()}}),t)})))),j.cachedChannelId&&j.joinChannelByID(j.cachedChannelId,!0).catch((function(e){Object(g.Toast)({type:"error",message:e.message||"Error"}),j.callBackFn()}))},this.globalMessage=function(e){Object(m.updateGlobalMessagingDetails)(e)(j.handler,j.getState)},this.joinChannelByID=function(){var e=Object(r.a)(c.a.mark((function e(t){var n,a=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.abrupt("return",new Promise(function(){var e=Object(r.a)(c.a.mark((function e(a,s){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n||j.unSubscribeChannel(),j.client){e.next=4;break}return e.abrupt("return",alert("Twilio loading"));case 4:return j.handler({type:u.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{isLoading:!0}}),j.log("Attempting to join ".concat(t," channel")),e.next=8,j.client.getChannelByUniqueName(t);case 8:return i=e.sent,e.next=11,j.joinChannel(i);case 11:return e.next=13,j.onChanelJoined(i);case 13:j.log("Channel joined"),j.activeChannel=i,i.on("messageAdded",function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.onMessagedAdded(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.on("typingStarted",(function(e){j.onParticipantStartTyping(e)})),i.on("typingEnded",(function(e){j.onParticipantEndedTyping(e)})),i.on("memberJoined",(function(e){j.onMemberJoined(e)})),i.on("memberLeft",(function(e){j.onMemberLeft(e)})),j.handler({type:u.MessagingActionType.UPDATE_CHANNEL_DETAILS,payload:i}),a(!0),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(0),j.log("Not able to join the channel"),s(e.t0);case 28:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.joinChannel=function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("joined"===t.channelState.status){e.next=3;break}return e.next=3,t.join();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onChanelJoined=function(){var e=Object(r.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMessages();case 2:n=e.sent,a=n.items||[],j.handler({type:u.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{activeChannelMessages:Object(s.a)(a),isLoading:!1}});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onMessagedAdded=function(e){return e.channel.sid!==j.activeChannel.sid?(console.log(e,"msg","diff channel"),{}):j.handler({type:u.MessagingActionType.UPDATE_MESSAGE_DETAILS,payload:e})},this.onParticipantStartTyping=function(e){var t={type:"typingStarted",participant:e};Object(m.updatePersonTyping)(t)(j.handler,j.getState)},this.onParticipantEndedTyping=function(e){var t={type:"typingEnded",participant:e};Object(m.updatePersonTyping)(t)(j.handler,j.getState)},this.onMemberJoined=function(e){var t=e.state.identity;return j.log("".concat(t," has joined the chat")),j.handler({type:u.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{status:"".concat(t," has joined the chat")}})},this.onMemberLeft=function(e){var t=e.state.identity;return j.log("".concat(t," has left the chat")),j.handler({type:u.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{status:"".concat(t," has left the chat")}})},this.getToken=function(){var e=d.twilioApi.getIdentityToken;return e.id=localStorage.getItem("user-id"),new Promise((function(t,n){Object(h.api)(Object(a.a)({},e)).then((function(e){var n=e.chatToken;t(n)})).catch((function(e){Object(g.Toast)({type:"error",message:e.message||"Error"}),n(e)}))}))},this.unSubscribeChannel=function(){j.activeChannel&&(j.activeChannel.removeAllListeners(),j.activeChannel=null,j.log("Un subscribed from the channel")),Object(m.resetChannelDetails)()(j.handler)},this.removeChatClient=function(){j.client&&(j.client.removeAllListeners(),j.client=null,j.handler({type:u.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{clientData:null}}),j.unSubscribeChannel(),j.log("chat client removed"))},this.getState=n,this.handler=t,this.activeChannel=null,this.client=null,this.cachedChannelId=i,this.callBackFn=l,this.initClient()}return Object(l.a)(e,[{key:"log",value:function(e){console.log("---------".concat(e,"------"))}}]),e}()},325:function(e,t,n){"use strict";n.r(t),n.d(t,"MessageComponent",(function(){return l}));var a=n(4),s=(n(2),n(297)),i=n(67),c=n(93),r=n(43),o=n(1),l=function(e){var t=e.isMessageListLoading,n=e.messageData,l=void 0===n?[]:n,u=e.PopulateContacts,d=void 0===u?function(){}:u;return Object(o.jsxs)("div",{className:"message_inner_one",children:[Object(o.jsx)("div",{className:"message_left",children:t?Object(o.jsx)(i.CommonPageLoader,{}):l.map((function(e,t){var n,s=e.message||{},i=s.from,l=s.body,u=s.date_updated,h=(null===(n=e.members)||void 0===n?void 0:n.filter((function(e){return e.userId===i}))[0])||e.members[0]||{};return Object(o.jsx)("div",{className:"contact_item",children:Object(o.jsxs)("div",{className:"inner_link",children:[Object(o.jsx)(r.UserAvatar,Object(a.a)(Object(a.a)({},h),{},{className:"img-md-2"})),Object(o.jsxs)("div",{className:"message_link_notify",onClick:function(){return d(e.channelUniqueName,e.members,e)},children:[Object(o.jsxs)("div",{style:{display:"flex"},children:[Object(o.jsx)("h3",{children:e.chatTitle||""}),Object(o.jsxs)("h3",{children:["\u2002",e.members.length>2?"+  "+(e.members.length-2):null]})]}),Object(o.jsxs)("div",{children:[l&&Object(o.jsx)("p",{children:"".concat(null===l||void 0===l?void 0:l.slice(0,100)).concat((null===l||void 0===l?void 0:l.length)>100?"...":"")}),u&&Object(o.jsx)("span",{className:"msg-timestamp-left",children:Object(c.getFormatDate)(u,"LT")})]})]})]})},"".concat(Date.now(),"_").concat(t))}))}),Object(o.jsx)("div",{className:"message_right",children:Object(o.jsx)(s.default,{isDataPresent:l.length>0})})]})}},427:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/Availability Icon.ad0517cb.svg"},428:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/Jenny.c50273b9.png"},430:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/Location Icon.cbb0b32d.svg"},433:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/Image 1.5667afc3.png"},449:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/Shedule Icon.7b9fb7aa.svg"},611:function(e,t,n){}}]);