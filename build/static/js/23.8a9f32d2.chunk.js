(this.webpackJsonpmotto=this.webpackJsonpmotto||[]).push([[23,85,106,138,144,164,185,249,383,384,385,478,479],{1025:function(e,t){},1038:function(e,t){},188:function(e,t,n){"use strict";n.r(t),n.d(t,"InfiniteScrollComponent",(function(){return b}));var a=n(5),s=n(14),i=n.n(s),c=n(28),r=n(20),o=n(21),l=n(27),u=n(26),d=n(2),h=n(78),g=n(344),m=n(1),b=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).toggleContent=function(e){var t=parseInt(e),n=a.state,s=n.showContent,i=(n.isMobile,s===t?"":t);a.setState({showContent:i},(function(){}))},a.handleAboutToReachBottom=Object(c.a)(i.a.mark((function e(){var t,n,s,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.isLoading,s=t.page,c=a.props.handleApi,a.setState({isLoading:!0}),!1!==n){e.next=9;break}return e.next=6,c(s+1);case 6:r=e.sent,r.data,a.setState({page:s+1,isLoading:!1});case 9:case"end":return e.stop()}}),e)}))),a.handleUpdate=function(e){var t=e.scrollTop,n=e.scrollHeight,s=e.clientHeight,i=a.state,c=i.isLoading,r=i.total,o=i.currentDataSize;(t+100)/(n-s)>1&&o<r&&!1===c&&a.handleAboutToReachBottom()},a.loader=function(){return Object(m.jsx)("div",{className:"d-flex flex-column align-items-center justify-content-center w-100 pt-3",children:Object(m.jsx)(h.CommonPageLoader,{})})},a.state={showContent:"",page:0,count:0,total:0,isMobile:!1,isLoading:!1,notificationData:[],currentDataSize:0,initialLoad:!0},a.refArray=[],a}return Object(o.a)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props.totalSize,n=this.state,a=n.initialLoad,s=n.currentDataSize;!a&&0===s&&t!==e.totalSize&&t>0&&(this.setState({currentDataSize:s,initialLoad:!0,total:t}),console.log("Runned"))}},{key:"componentDidMount",value:function(){var e=this.props,t=e.currentDataSize,n=e.totalSize;window.matchMedia("(max-width: 700px)").matches&&this.setState({isMobile:!0}),t>0?this.setState({total:n}):this.setState({initialLoad:!1})}},{key:"render",value:function(){var e=this.state,t=(e.showContent,e.total),n=e.isMobile,s=e.isLoading,i=(e.notificationData,e.initialLoad),c=n?{style:{height:550}}:{style:{height:500}},r={};return e.currentDataSize<t&&(r.onUpdate=this.handleUpdate),Object(m.jsx)("div",{className:"notification-page",children:Object(m.jsx)("div",{className:"notification-page-body",children:i?Object(m.jsxs)(g.CustomScrollbar,Object(a.a)(Object(a.a)(Object(a.a)({customStyle:{width:"12px",right:"5px"}},c),r),{},{children:[this.props.children,s&&this.loader()]})):Object(m.jsx)(h.CommonPageLoader,{className:"mt-5 pt-5"})})})}}]),n}(d.Component)},205:function(e,t,n){"use strict";n.r(t);var a=n(5),s=n(36),i=n(109),c=n(11),r=n(2),o=n(826),l=(n(824),n(651),n(471),n(475),n(480),n(467),n(473),n(67),n(77)),u=n(51),d=n(30),h=n(25),g=(n(6),n(113),n(38)),m=(n(334),n(338)),b=(n(111),n(47),n(78),n(188),n(7)),j=n(362),p=n(19),f=n(374),v=n(1),O=Object(d.b)((function(e){return{clientData:e.messagingReducer.clientData,activeChannel:e.messagingReducer.activeChannel,activeChannelMessages:e.messagingReducer.activeChannelMessages,typingMembers:e.messagingReducer.typingMembers,chatClientInstance:e.messagingReducer.chatClientInstance,pastSessions:e.messagingReducer.pastSessions,upcomingSessions:e.messagingReducer.upcomingSessions,requestedSessions:e.messagingReducer.requestedSessions,adminMessages:e.messagingReducer.adminMessages,userMessages:e.messagingReducer.userMessages,trainerMessages:e.messagingReducer.trainerMessages,invitedSessions:e.messagingReducer.invitedSessions}}),(function(e){return Object(h.b)({trainerChannel:l.trainerChannel,adminChannel:l.adminChannel,initClientDispatch:m.initClientDispatch,updateMessagingDetails:m.updateMessagingDetails,unSubscribeAct:m.unSubscribeFromChannel,unSubscribeClientAct:m.unSubscribeFromClient,change_login_status:u.change_login_status},e)}))((function(e){var t=e.trainerChannel,n=e.adminChannel,l=e.initClientDispatch,u=(e.clientData,e.activeChannel,e.activeChannelMessages,e.typingMembers,e.chatClientInstance),d=e.updateMessagingDetails,h=e.pastSessions,m=e.upcomingSessions,O=e.requestedSessions,y=e.adminMessages,x=e.userMessages,S=e.trainerMessages,C=e.invitedSessions,M=e.unSubscribeAct,T=e.unSubscribeClientAct,D=e.change_login_status,I=3===parseInt(localStorage.getItem("type")),_=1===parseInt(localStorage.getItem("type")),A=Object(p.h)().type,L=Object(r.useState)([]),N=Object(c.a)(L,2),w=(N[0],N[1],Object(r.useState)([])),E=Object(c.a)(w,2),k=(E[0],E[1],Object(r.useState)([])),P=Object(c.a)(k,2),R=(P[0],P[1],Object(r.useState)([])),U=Object(c.a)(R,2),F=(U[0],U[1],Object(r.useState)()),B=Object(c.a)(F,2),G=(B[0],B[1],Object(r.useState)([])),z=Object(c.a)(G,2),q=(z[0],z[1],Object(r.useState)([])),Y=Object(c.a)(q,2),J=(Y[0],Y[1],Object(r.useState)("")),H=Object(c.a)(J,2),K=(H[0],H[1],Object(r.useState)("")),V=Object(c.a)(K,2),Z=(V[0],V[1],Object(r.useState)(!0)),Q=Object(c.a)(Z,2),W=Q[0],X=Q[1],$=Object(r.useState)({invited:0,upcoming:0,past:0,admin:0}),ee=Object(c.a)($,2),te=ee[0],ne=(ee[1],Object(r.useState)(_?"trainer":"upcoming")),ae=Object(c.a)(ne,2),se=ae[0],ie=ae[1];Object(r.useEffect)((function(){D({loginStatus:!0}),window.scrollTo(0,0);var e=b.history.location.search,t=(e.split("=")[1],e.split("channelId=")[1]),n=window.matchMedia("(max-width: 700px)");return l(t,(function(){X(!1)})),function(){n.matches||T(),D({loginStatus:!1})}}),[]),Object(r.useEffect)((function(){var e=b.history.location.search;e.split("=")[1],e.split("channelId=")[1];A&&ie(A)}),[b.history.location]),Object(r.useEffect)((function(){ce(se)}),[te]);var ce=function(e){if(_)return re();var n=b.history.location.search.split("channelId=")[1];t(e,te[e]).then((function(t){var a={invited:"invitedSessions",upcoming:"upcomingSessions",past:"pastSessions",admin:"adminMessages",requested:"requestedSessions"},c=a[e];X(!1);var r=Object(s.a)({},c,Object(i.a)(t));if(A&&n){var o=Object(i.a)(r[a[A]]).filter((function(e){return e.channelId===n}))[0]||{};if(o.channelId){var l={currentChannelMembers:Object(i.a)(null===o||void 0===o?void 0:o.members),channelData:o};d(l)}}d(r)})).catch((function(e){X(!1)}))},re=function(){n().then((function(e){var t=e||{},n=t.trainersArray,s=void 0===n?[]:n,c=t.usersArray,r=void 0===c?[]:c,o=b.history.location.search,l={userMessages:Object(i.a)(r),trainerMessages:Object(i.a)(s)};X(!1);var u=o.split("channelId=")[1];if(u){var h=l[{trainer:"trainerMessages",user:"userMessages"}[A]].filter((function(e){return e.channelId===u}))[0]||{};l=Object(a.a)(Object(a.a)({},l),{},{currentChannelMembers:null===h||void 0===h?void 0:h.members,channelData:h})}d(l)})).catch((function(e){console.log(e),Object(g.Toast)({type:"error",message:e.message||"Error"})}))};function oe(e,t,n){var a=window.matchMedia("(max-width: 700px)");u.joinChannelByID(e).then((function(){d({currentChannelMembers:t,channelData:n}),a.matches&&b.history.push("/mobiles/chat")})).catch((function(e){console.log(e)}))}return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("div",{className:"main_message_container",children:[Object(v.jsx)(f.a,{ref:function(e){e},timeout:1e4,onActive:function(e){console.log("user is active"),null!==localStorage.getItem("token")&&D({loginStatus:!0})},onIdle:function(e){console.log("user is idle"),null!==localStorage.getItem("token")&&D({loginStatus:!1})},debounce:250}),Object(v.jsxs)("div",{className:"message_outter_container",children:[Object(v.jsx)("h2",{children:"Messages"}),Object(v.jsx)("div",{className:"message_inner",children:Object(v.jsxs)("div",{className:"message_wrapper",children:[Object(v.jsxs)(o.d,{defaultTab:se,onChange:function(e){!function(e){var t=A;b.history.location.search,_?e!==t&&b.history.push("/admins/message/".concat(e)):e!==t&&b.history.push("/".concat(I?"users":"trainers","/dashboard/message/").concat(e)),ie(e),X(!0),M(),ce(e)}(e)},children:[Object(v.jsx)(o.b,{children:_?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(o.a,{tabFor:"trainer",children:"Trainers"}),Object(v.jsx)(o.a,{tabFor:"user",children:"Users"})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(o.a,{tabFor:"upcoming",children:"Upcoming"}),I&&Object(v.jsx)(o.a,{tabFor:"invited",children:"Invited"}),Object(v.jsx)(o.a,{tabFor:"past",children:"Previous"}),Object(v.jsx)(o.a,{tabFor:"admin",children:"Admin"}),Object(v.jsx)(o.a,{tabFor:"requested",children:"Requests"})]})}),Object(v.jsxs)("div",{className:"message_inner",children:[Object(v.jsx)(o.c,{tabId:"invited",children:Object(v.jsx)(j.MessageComponent,{isMessageListLoading:W,messageData:C,PopulateContacts:oe})}),Object(v.jsx)(o.c,{tabId:"upcoming",children:Object(v.jsx)(j.MessageComponent,{isMessageListLoading:W,messageData:m,PopulateContacts:oe})}),Object(v.jsx)(o.c,{tabId:"past",children:Object(v.jsx)(j.MessageComponent,{isMessageListLoading:W,messageData:h,PopulateContacts:oe})}),Object(v.jsx)(o.c,{tabId:"admin",children:Object(v.jsx)(j.MessageComponent,{isMessageListLoading:W,messageData:y,PopulateContacts:oe})}),Object(v.jsx)(o.c,{tabId:"requested",children:Object(v.jsx)(j.MessageComponent,{isMessageListLoading:W,messageData:O,PopulateContacts:oe})}),Object(v.jsx)(o.c,{tabId:"user",children:Object(v.jsx)(j.MessageComponent,{isMessageListLoading:W,messageData:x,PopulateContacts:oe})}),Object(v.jsx)(o.c,{tabId:"trainer",children:Object(v.jsx)(j.MessageComponent,{isMessageListLoading:W,messageData:S,PopulateContacts:oe})})]})]}),Object(v.jsx)("div",{className:""})]})})]})]})})}));t.default=O},333:function(e,t,n){"use strict";n.r(t),n.d(t,"ChatItem",(function(){return o}));var a=n(5),s=(n(2),n(268)),i=n.n(s),c=(n(475),n(47)),r=n(1),o=function(e){var t,n=e.currentChannelMembers,s=void 0===n?[]:n,o=e.currMsg,l=o.type,u=o.state,d=o.date;if("message"===l){var h=i()(u.timestamp).format("LT"),g=(null===u||void 0===u?void 0:u.author)===localStorage.getItem("user-id"),m=s.filter((function(e){return e.userIdenity===u.author}))[0]||{};t=Object(r.jsxs)("div",{className:"message_chat_".concat(g?"right":"left"),children:[Object(r.jsxs)("div",{className:"message_text",children:[Object(r.jsx)("h5",{children:(null===u||void 0===u?void 0:u.body)||""}),Object(r.jsx)("span",{className:"msg-time",children:h})]}),Object(r.jsx)(c.UserAvatar,Object(a.a)({},m))]})}else t=Object(r.jsx)("div",{className:"w-100 d-flex align-items-center justify-content-center my-3",children:Object(r.jsx)("span",{className:"info-badge",children:d})});return Object(r.jsx)("div",{children:t})}},334:function(e,t,n){"use strict";n.r(t);var a=n(5),s=n(109),i=n(20),c=n(21),r=n(32),o=n(27),l=n(26),u=n(2),d=n.n(u),h=n(473),g=n(480),m=n(467),b=n(67),j=n(333),p=n(25),f=n(77),v=n(51),O=n(30),y=n(111),x=n(19),S=n(1),C=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var c;return Object(i.a)(this,n),(c=t.call(this,e)).scrollToMessageListBottom=function(){var e,t;null===(e=c.messagesEndRef.current)||void 0===e||e.scrollTo(0,null===(t=c.messagesEndRef.current)||void 0===t?void 0:t.scrollHeight)},c.handleChange=function(e){var t=e.target.value,n=c.props.activeChannel;c.setState({message:t}),n&&n.typing()},c.handleSendMessage=function(e){e.preventDefault();var t=c.state.message,n=c.props.activeChannel;if(!n)return console.log("Chat Service is not configured.");n&&""!==t&&n.sendMessage(String(t)).then((function(){c.setState({message:""}),c.scrollToMessageListBottom(),c.unread()}))},c.formatMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t="",n=e.reduce((function(e,n){var i=Object(s.a)(e),c=n.state.timestamp,r=Object(y.getFormatDate)(null,"YYYY"),o=Object(y.getFormatDate)(c,"YYYY"),l=Object(y.getFormatDate)(c,"MMMM DD"),u=r===o?l:"".concat(l,", ").concat(o);return t===u?i=[].concat(Object(s.a)(i),[Object(a.a)({type:"message"},n)]):(t=u,i=[].concat(Object(s.a)(i),[{type:"timestamp",date:u},Object(a.a)({type:"message"},n)])),i}),[]);return n},c.unread=function(){var e=[];c.setState({members:c.props.currentChannelMembers},(function(){var t=c.state.members.filter((function(e){return e.memberIdenity!==localStorage.getItem("user-id")}));e=t.map((function(e){return e.userId})),c.props.send_unread_notification({recepients:e})}))},c.handleKeyUp=function(e){13!=e.keyCode||e.shiftKey||c.handleSendMessage(e)},c.goBack=c.goBack.bind(Object(r.a)(c)),c.messagesEndRef=d.a.createRef(),c.state={message:"",members:[]},c}return Object(c.a)(n,[{key:"goBack",value:function(){this.props.history.goBack()}},{key:"componentDidUpdate",value:function(e){var t=this;this.props.activeChannelMessages.length!==e.activeChannelMessages.length&&this.scrollToMessageListBottom(),!1===this.props.isLoading&&!0===e.isLoading&&setTimeout((function(){t.scrollToMessageListBottom()}),100)}},{key:"componentDidMount",value:function(){this.scrollToMessageListBottom()}},{key:"render",value:function(){var e=this.props,t=e.activeChannelMessages,n=void 0===t?[]:t,a=e.typingMembers,s=void 0===a?[]:a,i=e.currentChannelMembers,c=void 0===i?[]:i,r=e.isLoading,o=void 0!==r&&r,l=e.activeChannel,u=void 0===l?{}:l,d=e.channelData,p=void 0===d?{}:d,f=e.isDataPresent,v=void 0!==f&&f,O=this.state.message,x=this.formatMessage(n);return v?Object(S.jsx)("div",{className:"message_right_chatarea",children:(null===u||void 0===u?void 0:u.sid)?Object(S.jsx)(S.Fragment,{children:o?Object(S.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center",children:Object(S.jsx)("span",{className:"info-badge",children:"".concat(o?"Loading...":"Connecting...")})}):Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("div",{className:"mobile_chat_header",children:[Object(S.jsx)("h2",{style:{textTransform:"Capitalize"},children:(null===p||void 0===p?void 0:p.chatTitle)||"Title"}),Object(S.jsx)("h1",{onClick:this.goBack,children:"\u2039"})]}),Object(S.jsxs)("div",{className:"message_right_header",children:[Object(S.jsx)("h2",{style:{textTransform:"Capitalize"},children:(null===p||void 0===p?void 0:p.chatTitle)||"Title"}),Object(S.jsxs)("div",{className:"message_header_times",children:[Object(S.jsxs)("div",{className:"message_header_items",children:[Object(S.jsx)("img",{src:g.default,alt:"icon"}),Object(S.jsx)("h5",{children:Object(y.getFormatDate)(null===p||void 0===p?void 0:p.startTime,"ddd MMM DD YYYY",!0)})]}),Object(S.jsxs)("div",{className:"message_header_items",children:[Object(S.jsx)("img",{src:m.default,alt:"icon"}),Object(S.jsx)("h5",{children:Object(y.getFormatDate)(null===p||void 0===p?void 0:p.startTime,"hh:mm A",!0)})]}),Object(S.jsxs)("div",{className:"message_header_items",children:[Object(S.jsx)("img",{src:h.default,alt:"icon"}),Object(S.jsx)("h5",{children:null===p||void 0===p?void 0:p.venue})]})]}),Object(S.jsx)("p",{children:s.length>0&&Object(S.jsx)("span",{className:"ml-auto text-primary fw-600",children:"".concat(s.toString()," ").concat(s.length>1?"are":"is"," typing...")})})]}),Object(S.jsxs)("div",{className:"message_right_textarea",ref:this.messagesEndRef,children:[(null===x||void 0===x?void 0:x.length)>0?x.map((function(e,t){return Object(S.jsx)(j.ChatItem,{item:e,currentChannelMembers:c,currMsg:e},"".concat(Date.now(),"_").concat(t))})):Object(S.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center",children:Object(S.jsx)("span",{className:"info-badge",children:"No message"})}),Object(S.jsx)("div",{id:"end-message"})]}),Object(S.jsx)("form",{className:"w-100",onSubmit:this.handleSendMessage,children:Object(S.jsxs)("div",{className:"message_right_input",children:[Object(S.jsx)("textarea",{type:"text",placeholder:"Type your message here..",value:O,onChange:this.handleChange,onKeyDown:this.handleKeyUp,onKeyPress:this.handleKeyUp}),Object(S.jsx)("div",{className:"submit-btn-block",onClick:this.handleSendMessage,children:Object(S.jsx)("button",{className:"transparent-btn",children:Object(S.jsx)(b.default,{})})})]})})]})}):Object(S.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center",children:Object(S.jsx)("span",{className:"info-badge",children:"".concat(o?"Loading...":"Select a chat to start messaging")})})}):Object(S.jsx)("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center",children:o?"":Object(S.jsx)("h3",{children:"No New Messages"})})}}]),n}(u.Component),M=Object(O.b)((function(e){return{clientData:e.messagingReducer.clientData,activeChannel:e.messagingReducer.activeChannel,activeChannelMessages:e.messagingReducer.activeChannelMessages,typingMembers:e.messagingReducer.typingMembers,chatClientInstance:e.messagingReducer.chatClientInstance,currentChannelMembers:e.messagingReducer.currentChannelMembers,isLoading:e.messagingReducer.isLoading,channelData:e.messagingReducer.channelData}}),(function(e){return Object(p.b)({trainerChannel:f.trainerChannel,send_unread_notification:v.send_unread_notification},e)}))(C);t.default=Object(x.i)(M)},338:function(e,t,n){"use strict";n.r(t),n.d(t,"updatePersonTyping",(function(){return r})),n.d(t,"resetChannelDetails",(function(){return o})),n.d(t,"updateMessagingDetails",(function(){return l})),n.d(t,"updateGlobalMessagingDetails",(function(){return u})),n.d(t,"initClientDispatch",(function(){return d})),n.d(t,"unSubscribeFromChannel",(function(){return h})),n.d(t,"unSubscribeFromClient",(function(){return g}));var a=n(5),s=n(109),i=n(15),c=n(348),r=function(e){return function(t,n){var a=n().messagingReducer,c=a.typingMembers,r=a.currentChannelMembers,o=e.type,l=e.participant.state.identity,u=c,d=(localStorage.getItem("user-id"),r.filter((function(e){return e.userIdenity===l}))[0]||{}),h=(null===d||void 0===d?void 0:d.userName)||l;"typingStarted"===o?c.includes(h)||(u=[].concat(Object(s.a)(c),[h]),t({type:i.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{typingMembers:Object(s.a)(u)}})):"typingEnded"===o&&c.includes(h)&&(u=Object(s.a)(c).filter((function(e){return e!==h})),t({type:i.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{typingMembers:Object(s.a)(u)}}))}},o=function(){return function(e){e({type:i.MessagingActionType.RESET_CHANNEL_DETAILS})}},l=function(e){return function(t){t({type:i.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:e})}},u=function(e){return function(t,n){var a,c,r,o,l=null===e||void 0===e||null===(a=e.channel)||void 0===a?void 0:a.sid,u=null===e||void 0===e||null===(c=e.state)||void 0===c?void 0:c.body,d=null===e||void 0===e||null===(r=e.state)||void 0===r?void 0:r.author,h=n().messagingReducer,g=h.pastSessions,b=h.upcomingSessions,j=h.adminMessages,p=h.invitedSessions,f=h.requestedSessions,v=h.userMessages,O=h.trainerMessages,y=Object(s.a)(g),x=Object(s.a)(b),S=Object(s.a)(p),C=Object(s.a)(j),M=Object(s.a)(f),T=Object(s.a)(v),D=Object(s.a)(O),I=m(y,l,u,d),_=m(x,l,u,d),A=m(M,l,u,d),L=m(S,l,u,d),N={pastSessions:I,upcomingSessions:_,requestedSessions:A,adminMessages:m(C,l,u,d),userMessages:m(T,l,u,d),trainerMessages:m(D,l,u,d),invitedSessions:L},w=document.getElementsByClassName("message_left");null===(o=Object(s.a)(w))||void 0===o||o.forEach((function(e){return null===e||void 0===e?void 0:e.scrollTo(0,0)})),t({type:i.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:N})}},d=function(e,t){return function(n,a){n({type:i.MessagingActionType.UPDATE_CLIENT_INSTANCE,payload:new c.default(n,a,e,t)})}},h=function(){return function(e,t){var n=t().messagingReducer.chatClientInstance;n&&n.unSubscribeChannel()}},g=function(){return function(e,t){var n=t().messagingReducer.chatClientInstance;n&&n.removeChatClient()}},m=function(e,t,n,i){var c=Object(s.a)(e).map((function(e){var s=Object(a.a)({},e);return(null===e||void 0===e?void 0:e.channelId)===t&&(Object.keys(s).includes("message")||(s.message={}),s.message.body=n,s.message.date_updated=(new Date).toISOString(),s.message.from=i),Object(a.a)({},s)}));return c=c.sort((function(e,t){var n,a;return new Date((null===t||void 0===t||null===(n=t.message)||void 0===n?void 0:n.date_updated)||1950)-new Date((null===e||void 0===e||null===(a=e.message)||void 0===a?void 0:a.date_updated)||1950)})),Object(s.a)(c)}},344:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomScrollbar",(function(){return g}));var a=n(5),s=n(60),i=n(20),c=n(21),r=n(27),o=n(26),l=n(2),u=n.n(l),d=n(973),h=n(1),g=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(i.a)(this,n);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).scrollbars=u.a.createRef(),e.state={mounted:!1},e.renderThumb=function(t){var n=t.style,i=Object(s.a)(t,["style"]),c=e.props.customStyle,r=Object(a.a)({backgroundColor:"#f2f2f2",borderRadius:"8px",width:"16px"},c);return Object(h.jsx)("div",Object(a.a)(Object(a.a)({style:Object(a.a)(Object(a.a)({},n),r)},i),{},{className:"render-y"}))},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.setState({mounted:!0})}},{key:"componentDidUpdate",value:function(){var e=this.props.scrollToBottomUpdate;void 0!==e&&e&&this.state.mounted&&this.scrollbars.current.scrollToBottom()}},{key:"renderView",value:function(e){var t=e.style,n=Object(s.a)(e,["style"]);return Object(h.jsx)("div",Object(a.a)(Object(a.a)({style:Object(a.a)({},t)},n),{},{className:"h"}))}},{key:"render",value:function(){var e=this.props,t=(e.customStyle,Object(s.a)(e,["customStyle"]));return Object(h.jsx)(d.Scrollbars,Object(a.a)({ref:this.scrollbars,renderThumbHorizontal:this.renderThumb,renderThumbVertical:this.renderThumb,renderView:this.renderView},t))}}]),n}(l.Component)},348:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var a=n(5),s=n(109),i=n(14),c=n.n(i),r=n(28),o=n(20),l=n(21),u=n(15),d=n(6),h=n(113),g=n(38),m=n(338),b=n(989),j=function(){function e(t,n,i,l){var j=this;Object(o.a)(this,e),this.initClient=Object(r.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getToken();case 2:return t=e.sent,e.next=5,b.Client.create(t);case 5:n=e.sent,j.client=n,j.handler({type:u.MessagingActionType.INITIALIZE_CLIENT,payload:n}),j.initClientListeners(n);case 9:case"end":return e.stop()}}),e)}))),this.initClientListeners=function(e){e.removeAllListeners(),e.on("messageAdded",function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j.globalMessage(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.on("typingStarted",(function(e){j.onParticipantStartTyping(e)})),e.on("typingEnded",(function(e){j.onParticipantEndedTyping(e)})),e.on("tokenAboutToExpire",Object(r.a)(c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j.log("token is about to expire"),t.next=3,j.getToken();case 3:n=t.sent,e.updateToken(n);case 5:case"end":return t.stop()}}),t)})))),e.on("tokenExpired",Object(r.a)(c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j.log("token is about to expire"),t.next=3,j.getToken();case 3:n=t.sent,e.updateToken(n);case 5:case"end":return t.stop()}}),t)})))),j.cachedChannelId&&j.joinChannelByID(j.cachedChannelId,!0).catch((function(e){Object(g.Toast)({type:"error",message:e.message||"Error"}),j.callBackFn()}))},this.globalMessage=function(e){Object(m.updateGlobalMessagingDetails)(e)(j.handler,j.getState)},this.joinChannelByID=function(){var e=Object(r.a)(c.a.mark((function e(t){var n,a=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.abrupt("return",new Promise(function(){var e=Object(r.a)(c.a.mark((function e(a,s){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n||j.unSubscribeChannel(),j.client){e.next=4;break}return e.abrupt("return",alert("Twilio loading"));case 4:return j.handler({type:u.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{isLoading:!0}}),j.log("Attempting to join ".concat(t," channel")),e.next=8,j.client.getChannelByUniqueName(t);case 8:return i=e.sent,e.next=11,j.joinChannel(i);case 11:return e.next=13,j.onChanelJoined(i);case 13:j.log("Channel joined"),j.activeChannel=i,i.on("messageAdded",function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.onMessagedAdded(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.on("typingStarted",(function(e){j.onParticipantStartTyping(e)})),i.on("typingEnded",(function(e){j.onParticipantEndedTyping(e)})),i.on("memberJoined",(function(e){j.onMemberJoined(e)})),i.on("memberLeft",(function(e){j.onMemberLeft(e)})),j.handler({type:u.MessagingActionType.UPDATE_CHANNEL_DETAILS,payload:i}),a(!0),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(0),j.log("Not able to join the channel"),s(e.t0);case 28:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.joinChannel=function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("joined"===t.channelState.status){e.next=3;break}return e.next=3,t.join();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onChanelJoined=function(){var e=Object(r.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMessages();case 2:n=e.sent,a=n.items||[],j.handler({type:u.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{activeChannelMessages:Object(s.a)(a),isLoading:!1}});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onMessagedAdded=function(e){return e.channel.sid!==j.activeChannel.sid?(console.log(e,"msg","diff channel"),{}):j.handler({type:u.MessagingActionType.UPDATE_MESSAGE_DETAILS,payload:e})},this.onParticipantStartTyping=function(e){var t={type:"typingStarted",participant:e};Object(m.updatePersonTyping)(t)(j.handler,j.getState)},this.onParticipantEndedTyping=function(e){var t={type:"typingEnded",participant:e};Object(m.updatePersonTyping)(t)(j.handler,j.getState)},this.onMemberJoined=function(e){var t=e.state.identity;return j.log("".concat(t," has joined the chat")),j.handler({type:u.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{status:"".concat(t," has joined the chat")}})},this.onMemberLeft=function(e){var t=e.state.identity;return j.log("".concat(t," has left the chat")),j.handler({type:u.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{status:"".concat(t," has left the chat")}})},this.getToken=function(){var e=d.twilioApi.getIdentityToken;return e.id=localStorage.getItem("user-id"),new Promise((function(t,n){Object(h.api)(Object(a.a)({},e)).then((function(e){var n=e.chatToken;t(n)})).catch((function(e){Object(g.Toast)({type:"error",message:e.message||"Error"}),n(e)}))}))},this.unSubscribeChannel=function(){j.activeChannel&&(j.activeChannel.removeAllListeners(),j.activeChannel=null,j.log("Un subscribed from the channel")),Object(m.resetChannelDetails)()(j.handler)},this.removeChatClient=function(){j.client&&(j.client.removeAllListeners(),j.client=null,j.handler({type:u.MessagingActionType.UPDATE_MESSAGING_DETAILS,payload:{clientData:null}}),j.unSubscribeChannel(),j.log("chat client removed"))},this.getState=n,this.handler=t,this.activeChannel=null,this.client=null,this.cachedChannelId=i,this.callBackFn=l,this.initClient()}return Object(l.a)(e,[{key:"log",value:function(e){console.log("---------".concat(e,"------"))}}]),e}()},362:function(e,t,n){"use strict";n.r(t),n.d(t,"MessageComponent",(function(){return l}));var a=n(5),s=(n(2),n(334)),i=n(78),c=n(111),r=n(47),o=n(1),l=function(e){var t=e.isMessageListLoading,n=e.messageData,l=void 0===n?[]:n,u=e.PopulateContacts,d=void 0===u?function(){}:u;return Object(o.jsxs)("div",{className:"message_inner_one",children:[Object(o.jsx)("div",{className:"message_left",children:t?Object(o.jsx)(i.CommonPageLoader,{}):l.map((function(e,t){var n,s=e.message||{},i=s.from,l=s.body,u=s.date_updated,h=(null===(n=e.members)||void 0===n?void 0:n.filter((function(e){return e.userId===i}))[0])||e.members[0]||{};return Object(o.jsx)("div",{className:"contact_item",children:Object(o.jsxs)("div",{className:"inner_link",children:[Object(o.jsx)(r.UserAvatar,Object(a.a)(Object(a.a)({},h),{},{className:"img-md-2"})),Object(o.jsxs)("div",{className:"message_link_notify",onClick:function(){return d(e.channelUniqueName,e.members,e)},children:[Object(o.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between"},children:[Object(o.jsxs)("div",{style:{display:"flex",width:"85%"},children:[Object(o.jsx)("h3",{style:{textTransform:"Capitalize"},children:e.chatTitle||""}),Object(o.jsxs)("h3",{children:["\u2002",e.members.length>2?"+  "+(e.members.length-2):null]})]}),u&&Object(o.jsx)("span",{className:"msg-timestamp-left",children:Object(c.getFormatDate)(u,"LT")})]}),Object(o.jsx)("div",{children:l&&Object(o.jsx)("p",{children:"".concat(null===l||void 0===l?void 0:l.slice(0,100)).concat((null===l||void 0===l?void 0:l.length)>100?"...":"")})})]})]})},"".concat(Date.now(),"_").concat(t))}))}),Object(o.jsx)("div",{className:"message_right",children:Object(o.jsx)(s.default,{isDataPresent:l.length>0})})]})}},467:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/Availability Icon.ad0517cb.svg"},471:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/Jenny.c50273b9.png"},473:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/Location Icon.cbb0b32d.svg"},475:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/Image 1.5667afc3.png"},480:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/Shedule Icon.7b9fb7aa.svg"},651:function(e,t,n){}}]);