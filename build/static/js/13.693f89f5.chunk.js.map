{"version":3,"sources":["component/UserBookSession/UserPayments/subcomponents/CardForm.js"],"names":["CardForm","connect","dispatch","bindActionCreators","updateUserDetails","agreedToTerms","handleChange","ScheduleSession","stripe","useStripe","elements","useElements","useMemo","style","base","color","letterSpacing","fontFamily","invalid","useState","isRememberCard","setRememberCard","defaulCardDetails","setDefaultCardDetails","showCardComp","setShowCardComp","useEffect","getUserPaymentInfo","handleSubmit","event","a","preventDefault","cardElement","getElement","CardNumberElement","createPaymentMethod","type","card","error","paymentMethod","console","log","createToken","then","token","addCard","id","addCardDetails","PaymentApi","payload","cardToken","setDefault","body","api","data","Toast","message","catch","err","getPaymentMethods","filter","default","length","reduxData","onSubmit","className","options","hidePostalCode","fontSize","last4","exp_month","exp_year","onClick","checked","onChange","for","to","width","marginRight","disabled"],"mappings":"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","file":"static/js/13.693f89f5.chunk.js","sourcesContent":["import React, { useMemo, useState, useEffect } from \"react\";\r\nimport {\r\n  useStripe,\r\n  useElements,\r\n  CardNumberElement,\r\n  CardCvcElement,\r\n  CardExpiryElement,\r\n} from \"@stripe/react-stripe-js\";\r\nimport \"../styles.scss\";\r\nimport ArrowHoverBlacked from \"../../../common/BlackCircleButton/ArrowHoverBlacked\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { PaymentApi } from \"service/apiVariables\";\r\nimport { api } from \"service/api\";\r\nimport { updateUserDetails } from \"action/userAct\";\r\nimport { bindActionCreators } from \"redux\";\r\nimport { connect } from \"react-redux\";\r\nimport { Toast } from \"service/toast\";\r\nimport InfoIcon from \"@material-ui/icons/Info\";\r\nimport { AiFillAlert, AiOutlineAlert } from \"react-icons/ai\";\r\n\r\nconst useOptions = () => {\r\n  const options = useMemo(() => ({\r\n    style: {\r\n      base: {\r\n        color: \"#424770\",\r\n        letterSpacing: \"0.025em\",\r\n        fontFamily: \"Source Code Pro, monospace\",\r\n        \"::placeholder\": {\r\n          color: \"#aab7c4\",\r\n        },\r\n      },\r\n      invalid: {\r\n        color: \"#9e2146\",\r\n      },\r\n    },\r\n  }));\r\n\r\n  return options;\r\n};\r\n\r\nfunction CardFormFC({\r\n  updateUserDetails,\r\n  agreedToTerms,\r\n  handleChange,\r\n  ScheduleSession,\r\n}) {\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n  const options = useOptions();\r\n  const [isRememberCard, setRememberCard] = useState(false);\r\n  const [defaulCardDetails, setDefaultCardDetails] = useState({});\r\n  const [showCardComp, setShowCardComp] = useState(true);\r\n  // const [agreedToTerms, setAgreedToTerms] = useState(false);\r\n\r\n  useEffect(() => {\r\n    getUserPaymentInfo();\r\n  }, []);\r\n\r\n  const handleSubmit = async (event) => {\r\n    // Block native form submission.\r\n    event.preventDefault();\r\n\r\n    if (!showCardComp) return ScheduleSession();\r\n\r\n    if (!stripe || !elements) {\r\n      // Stripe.js has not loaded yet. Make sure to disable\r\n      // form submission until Stripe.js has loaded.\r\n      return;\r\n    }\r\n\r\n    // Get a reference to a mounted CardElement. Elements knows how\r\n    // to find your CardElement because there can only ever be one of\r\n    // each type of element.\r\n    const cardElement = elements.getElement(CardNumberElement);\r\n\r\n    // console.log(cardElement);\r\n\r\n    // Use your card Element with other Stripe.js APIs\r\n    const { error, paymentMethod } = await stripe.createPaymentMethod({\r\n      type: \"card\",\r\n      card: cardElement,\r\n    });\r\n\r\n    if (error) {\r\n      console.log(\"[error]\", error);\r\n    } else {\r\n      console.log(\"[PaymentMethod]\", paymentMethod);\r\n    }\r\n\r\n    stripe.createToken(cardElement).then(function ({ token }) {\r\n      // Handle result.error or result.token\r\n      addCard(token.id);\r\n\r\n      //   console.log(result, \"token\");\r\n    });\r\n\r\n    // alert(\"Card Saved\");\r\n  };\r\n\r\n  const addCard = (token) => {\r\n    const { addCardDetails } = PaymentApi;\r\n\r\n    let payload = {\r\n      cardToken: token,\r\n      setDefault: isRememberCard,\r\n    };\r\n\r\n    addCardDetails.body = payload;\r\n\r\n    api({ ...addCardDetails })\r\n      .then(({ data }) => {\r\n        console.log(data);\r\n\r\n        Toast({ type: \"success\", message: \"Card details added\" });\r\n        ScheduleSession();\r\n        getUserPaymentInfo();\r\n      })\r\n      .catch((err) => {\r\n        Toast({ type: \"error\", message: err.message || \"Error\" });\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  const getUserPaymentInfo = () => {\r\n    const { getPaymentMethods } = PaymentApi;\r\n\r\n    api({ ...getPaymentMethods })\r\n      .then(({ data = [] }) => {\r\n        let tempData = data || [];\r\n\r\n        const defaulCardDetails = tempData.filter((data) => data.default);\r\n\r\n        if (defaulCardDetails.length > 0) {\r\n          setDefaultCardDetails(defaulCardDetails[0]);\r\n          setShowCardComp(false);\r\n\r\n          let reduxData = {\r\n            defaulCardDetails: defaulCardDetails[0],\r\n          };\r\n\r\n          console.log(reduxData);\r\n          updateUserDetails(reduxData);\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <form onSubmit={handleSubmit} className=\"Card\">\r\n        <div className=\"payment_input_inner\">\r\n          <label>Card Number</label>\r\n\r\n          {showCardComp ? (\r\n            <CardNumberElement\r\n              options={{\r\n                hidePostalCode: true,\r\n                style: {\r\n                  base: {\r\n                    fontSize: \"16px\",\r\n                    color: \"#424770\",\r\n                    \"::placeholder\": {\r\n                      color: \"#898989\",\r\n                      fontFamily: \"Montserrat\",\r\n                      fontSize: \"16px\",\r\n                    },\r\n                  },\r\n                  invalid: {\r\n                    color: \"#9e2146\",\r\n                  },\r\n                },\r\n              }}\r\n            />\r\n          ) : (\r\n            <p className=\"fs-20\">{`**** **** **** ${\r\n              defaulCardDetails?.card?.last4 || \"****\"\r\n            }`}</p>\r\n          )}\r\n\r\n          <div className=\"payment_expire_input\">\r\n            <div className=\"payment_expire_inner\">\r\n              <label>\r\n                Expiry Date\r\n                {showCardComp ? (\r\n                  <CardExpiryElement\r\n                    options={{\r\n                      style: {\r\n                        base: {\r\n                          fontSize: \"16px\",\r\n                          color: \"#424770\",\r\n                          \"::placeholder\": {\r\n                            color: \"#898989\",\r\n                            fontFamily: \"Montserrat\",\r\n                            fontSize: \"16px\",\r\n                          },\r\n                        },\r\n                        invalid: {\r\n                          color: \"#9e2146\",\r\n                        },\r\n                      },\r\n                    }}\r\n                  />\r\n                ) : (\r\n                  <p className=\"fs-20\">{`${\r\n                    defaulCardDetails?.card?.exp_month || \"\"\r\n                  }/${defaulCardDetails?.card?.exp_year || \"\"}`}</p>\r\n                )}\r\n              </label>\r\n            </div>\r\n            <div className=\"payment_expire_inner\">\r\n              {showCardComp && (\r\n                <label>\r\n                  CVC/CVV\r\n                  <CardCvcElement\r\n                    options={{\r\n                      style: {\r\n                        base: {\r\n                          fontSize: \"16px\",\r\n                          color: \"#424770\",\r\n                          \"::placeholder\": {\r\n                            color: \"#898989\",\r\n                            fontFamily: \"Montserrat\",\r\n                            fontSize: \"16px\",\r\n                          },\r\n                        },\r\n                        invalid: {\r\n                          color: \"#9e2146\",\r\n                        },\r\n                      },\r\n                    }}\r\n                  />\r\n                </label>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {defaulCardDetails.default && (\r\n            <>\r\n              {showCardComp ? (\r\n                <div className=\"payment_change d-flex justify-content-end\">\r\n                  <button\r\n                    className=\"link-btn\"\r\n                    onClick={() => setShowCardComp(false)}\r\n                  >\r\n                    Reset Card\r\n                  </button>\r\n                </div>\r\n              ) : (\r\n                <div className=\"payment_change d-flex justify-content-end\">\r\n                  <button\r\n                    className=\"link-btn\"\r\n                    onClick={() => setShowCardComp(true)}\r\n                  >\r\n                    Edit Card\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n\r\n          {showCardComp && (\r\n            <div className=\"payment_input_check mt-3\">\r\n              <div className=\"payment_check_inner\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={isRememberCard}\r\n                  onChange={() => setRememberCard(!isRememberCard)}\r\n                  id=\"remember_card\"\r\n                />\r\n                <label for=\"remember_card\">Remember My Card Details</label>\r\n              </div>\r\n              <div className=\"payment_check_inner\">\r\n                <Link to=\"/\">Session Cancellation Policy</Link>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"payment_input_outter_check \">\r\n          <div className=\"payment_terms\">\r\n            <input\r\n              type=\"checkbox\"\r\n              style={{ width: \"20px\", marginRight: \"10px\" }}\r\n              onChange={handleChange}\r\n              checked={agreedToTerms}\r\n            />\r\n            <label>\r\n              By proceeding, you accept the latest versions of our{\" \"}\r\n              <Link to=\"/\">Terms of Use</Link> and{\" \"}\r\n              <Link to=\"/\">Privacy Policy</Link>\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"disclaimer\">\r\n          <p className=\"text-info\">\r\n            <InfoIcon />\r\n            <span>\r\n              Payment will happen only after the session is completed.\r\n            </span>\r\n          </p>\r\n        </div>\r\n\r\n        {/* {showCardComp && ( */}\r\n        <div className=\"submit\">\r\n          <button\r\n            type=\"click\"\r\n            className={`${!agreedToTerms ? \"disable-btn\" : \"\"}`}\r\n            disabled={!agreedToTerms}\r\n            onClick={handleSubmit}\r\n          >\r\n            Continue <ArrowHoverBlacked />\r\n          </button>\r\n        </div>\r\n        {/* )} */}\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return bindActionCreators(\r\n    {\r\n      updateUserDetails,\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nconst CardForm = connect(null, mapDispatchToProps)(CardFormFC);\r\n\r\nexport default CardForm;\r\n"],"sourceRoot":""}